[
    {
        "id": "d452c59951683d0a",
        "type": "tab",
        "label": "RSS sources",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "fbfe0ebdc384782c",
        "type": "tab",
        "label": "APTA",
        "disabled": false,
        "info": ""
    },
    {
        "id": "7cb4a59faa141113",
        "type": "tab",
        "label": "BioMed Central",
        "disabled": false,
        "info": ""
    },
    {
        "id": "aeea6501e40186b3",
        "type": "tab",
        "label": "PEDro",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d9d95b7db82b44be",
        "type": "tab",
        "label": "Scielo",
        "disabled": false,
        "info": ""
    },
    {
        "id": "4e972c81ceb89218",
        "type": "tab",
        "label": "The Lancet",
        "disabled": false,
        "info": ""
    },
    {
        "id": "ef4efdb19a1e5bd7",
        "type": "tab",
        "label": "JNeuroSci",
        "disabled": false,
        "info": ""
    },
    {
        "id": "229c44d5bbf84eb1",
        "type": "tab",
        "label": "MS and Rel. Disorders",
        "disabled": false,
        "info": ""
    },
    {
        "id": "02847583794d9f3b",
        "type": "tab",
        "label": "Clinical Trials",
        "disabled": false,
        "info": ""
    },
    {
        "id": "84a5d0feb9217f90",
        "type": "tab",
        "label": "Email Digest",
        "disabled": false,
        "info": ""
    },
    {
        "id": "8950ec157392345e",
        "type": "tab",
        "label": "Machine Learning",
        "disabled": false,
        "info": ""
    },
    {
        "id": "d92bbc0c206c5bfc",
        "type": "tab",
        "label": "Twitter",
        "disabled": false,
        "info": ""
    },
    {
        "id": "f8778833ef599a1e",
        "type": "tab",
        "label": "Contact form",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "b9a1fa1506c3f2d5",
        "type": "tab",
        "label": "DB Maintenance",
        "disabled": false,
        "info": "",
        "env": []
    },
    {
        "id": "e434ba9f4ebb748f",
        "type": "tab",
        "label": "tests",
        "disabled": false,
        "info": ""
    },
    {
        "id": "a38a4dce4a95b8aa",
        "type": "tab",
        "label": "!Journals.SagePub (not working)",
        "disabled": false,
        "info": ""
    },
    {
        "id": "acf883d8.84eea",
        "type": "subflow",
        "name": "Create SQL Command",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "4c001d43.2cc414"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 340,
                "y": 80,
                "wires": [
                    {
                        "id": "4c001d43.2cc414",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "d353eec5835441c0",
        "type": "subflow",
        "name": "throttle requests",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 120,
                "y": 160,
                "wires": [
                    {
                        "id": "eb444d3ffa4f324c"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 660,
                "y": 160,
                "wires": [
                    {
                        "id": "d5716d48a6a85ee3",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "822a1abe384d181e",
        "type": "subflow",
        "name": "Add to DB",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "eb49695acf2247b5"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 540,
                "y": 80,
                "wires": [
                    {
                        "id": "948d3c8c302e2380",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "3d5c22a1ade8c013",
        "type": "subflow",
        "name": "Create SQL Command",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "a5116b9ed1662449"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 680,
                "y": 80,
                "wires": [
                    {
                        "id": "155c6a50daad47fa",
                        "port": 0
                    },
                    {
                        "id": "49e212b9f443fac4",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "346ec29c7e27ea2e",
        "type": "subflow",
        "name": "Add to DB (2)",
        "info": "",
        "category": "",
        "in": [
            {
                "x": 60,
                "y": 80,
                "wires": [
                    {
                        "id": "7f8444988dff4341"
                    }
                ]
            }
        ],
        "out": [
            {
                "x": 540,
                "y": 80,
                "wires": [
                    {
                        "id": "2229ac4ea081f396",
                        "port": 0
                    }
                ]
            }
        ],
        "env": [],
        "meta": {},
        "color": "#DDAA99"
    },
    {
        "id": "27183810297269c1",
        "type": "group",
        "z": "8950ec157392345e",
        "style": {
            "stroke": "#999999",
            "stroke-opacity": "1",
            "fill": "none",
            "fill-opacity": "1",
            "label": true,
            "label-position": "nw",
            "color": "#a4a4a4"
        },
        "nodes": [
            "cbdd4e4b236e4da3",
            "5ddb96550ba669fc",
            "66f41ac3333740a9",
            "d3a6e1792df3a8c5",
            "61a4dc47f3f813d8",
            "4398218e763bce5a",
            "7ad6c1619dcbcd0a",
            "f9cde35485011e98",
            "ed5b8ee5804626d4",
            "c9797ce85aee3357",
            "e0b8f9989ee565b1",
            "1fc6d688700df5e6"
        ],
        "x": 14,
        "y": 519,
        "w": 952,
        "h": 362
    },
    {
        "id": "e3876559.c845b8",
        "type": "tls-config",
        "name": "",
        "cert": "",
        "key": "",
        "ca": "",
        "certname": "node-cert.pem",
        "keyname": "node-key.pem",
        "caname": "",
        "servername": "",
        "verifyservercert": true
    },
    {
        "id": "9ccc1658.e12858",
        "type": "sqlitedb",
        "db": "/data/gregory.db",
        "mode": "RWC"
    },
    {
        "id": "58fc87aecc126c39",
        "type": "ui_base",
        "theme": {
            "name": "theme-light",
            "lightTheme": {
                "default": "#0094CE",
                "baseColor": "#0094CE",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": true,
                "reset": false
            },
            "darkTheme": {
                "default": "#097479",
                "baseColor": "#097479",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif",
                "edited": false
            },
            "customTheme": {
                "name": "Untitled Theme 1",
                "default": "#4B7930",
                "baseColor": "#4B7930",
                "baseFont": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
            },
            "themeState": {
                "base-color": {
                    "default": "#0094CE",
                    "value": "#0094CE",
                    "edited": false
                },
                "page-titlebar-backgroundColor": {
                    "value": "#0094CE",
                    "edited": false
                },
                "page-backgroundColor": {
                    "value": "#fafafa",
                    "edited": false
                },
                "page-sidebar-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-textColor": {
                    "value": "#1bbfff",
                    "edited": false
                },
                "group-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "group-backgroundColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "widget-textColor": {
                    "value": "#111111",
                    "edited": false
                },
                "widget-backgroundColor": {
                    "value": "#0094ce",
                    "edited": false
                },
                "widget-borderColor": {
                    "value": "#ffffff",
                    "edited": false
                },
                "base-font": {
                    "value": "-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Oxygen-Sans,Ubuntu,Cantarell,Helvetica Neue,sans-serif"
                }
            },
            "angularTheme": {
                "primary": "indigo",
                "accents": "blue",
                "warn": "red",
                "background": "grey",
                "palette": "light"
            }
        },
        "site": {
            "name": "Node-RED Dashboard",
            "hideToolbar": "false",
            "allowSwipe": "false",
            "lockMenu": "false",
            "allowTempTheme": "true",
            "dateFormat": "DD/MM/YYYY",
            "sizes": {
                "sx": 48,
                "sy": 48,
                "gx": 6,
                "gy": 6,
                "cx": 6,
                "cy": 6,
                "px": 0,
                "py": 0
            }
        }
    },
    {
        "id": "857f821ab371a10e",
        "type": "postgresdb",
        "cfgname": "",
        "hostname": "db",
        "port": "5432",
        "db": "gregorybackoffice",
        "ssl": false
    },
    {
        "id": "4c001d43.2cc414",
        "type": "template",
        "z": "acf883d8.84eea",
        "name": "",
        "field": "topic",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "INSERT INTO articles (discovery_date,title,summary,link,published_date,source,relevant)\nVALUES (strftime(\"%Y-%m-%dT%H:%M:%SZ\", \"NOW\"),\"{{article.title}}\",\"{{article.description}}\",\"{{{article.url}}}\",\"{{article.pubdate}}\",\"{{{article.source}}}\",NULL)",
        "output": "str",
        "x": 200,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "d5716d48a6a85ee3",
        "type": "delay",
        "z": "d353eec5835441c0",
        "name": "",
        "pauseType": "rate",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": true,
        "outputs": 1,
        "x": 490,
        "y": 160,
        "wires": [
            []
        ]
    },
    {
        "id": "eb444d3ffa4f324c",
        "type": "change",
        "z": "d353eec5835441c0",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "rate",
                "pt": "msg",
                "to": "200",
                "tot": "num"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 160,
        "wires": [
            [
                "d5716d48a6a85ee3"
            ]
        ]
    },
    {
        "id": "eb49695acf2247b5",
        "type": "delay",
        "z": "822a1abe384d181e",
        "name": "",
        "pauseType": "random",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "200",
        "randomLast": "300",
        "randomUnits": "milliseconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "948d3c8c302e2380"
            ]
        ]
    },
    {
        "id": "948d3c8c302e2380",
        "type": "sqlite",
        "z": "822a1abe384d181e",
        "mydb": "9ccc1658.e12858",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "",
        "x": 370,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "155c6a50daad47fa",
        "type": "template",
        "z": "3d5c22a1ade8c013",
        "name": "msg.payload",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "INSERT INTO \"public\".\"articles\" (discovery_date,title,summary,link,published_date,source,relevant)\nVALUES (current_timestamp,'{{article.title}}','{{article.description}}','{{{article.url}}}',{{article.pubdate}},{{source}},NULL);",
        "output": "str",
        "x": 550,
        "y": 60,
        "wires": [
            []
        ]
    },
    {
        "id": "a5116b9ed1662449",
        "type": "switch",
        "z": "3d5c22a1ade8c013",
        "name": "",
        "property": "article.pubdate",
        "propertyType": "msg",
        "rules": [
            {
                "t": "empty"
            },
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 150,
        "y": 80,
        "wires": [
            [
                "b4c398bdb4db1159"
            ],
            [
                "49e212b9f443fac4"
            ]
        ]
    },
    {
        "id": "b4c398bdb4db1159",
        "type": "change",
        "z": "3d5c22a1ade8c013",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article.pubdate",
                "pt": "msg",
                "to": "NULL",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 60,
        "wires": [
            [
                "155c6a50daad47fa"
            ]
        ]
    },
    {
        "id": "49e212b9f443fac4",
        "type": "template",
        "z": "3d5c22a1ade8c013",
        "name": "msg.payload",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "INSERT INTO \"public\".\"articles\" (discovery_date,title,summary,link,published_date,source,relevant)\nVALUES (current_timestamp,'{{article.title}}','{{article.description}}','{{{article.url}}}','{{article.pubdate}}',{{source}},NULL);",
        "output": "str",
        "x": 550,
        "y": 120,
        "wires": [
            []
        ]
    },
    {
        "id": "7f8444988dff4341",
        "type": "delay",
        "z": "346ec29c7e27ea2e",
        "name": "",
        "pauseType": "random",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "200",
        "randomLast": "300",
        "randomUnits": "milliseconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 200,
        "y": 80,
        "wires": [
            [
                "2229ac4ea081f396"
            ]
        ]
    },
    {
        "id": "2229ac4ea081f396",
        "type": "sqlite",
        "z": "346ec29c7e27ea2e",
        "mydb": "9ccc1658.e12858",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "",
        "x": 370,
        "y": 80,
        "wires": [
            []
        ]
    },
    {
        "id": "36f564009466205b",
        "type": "inject",
        "z": "d452c59951683d0a",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 200,
        "y": 80,
        "wires": [
            [
                "9fabc047a1ee01a3"
            ]
        ]
    },
    {
        "id": "9fabc047a1ee01a3",
        "type": "exec",
        "z": "d452c59951683d0a",
        "command": "/usr/bin/python3 /python-ml/feedreader.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 460,
        "y": 80,
        "wires": [
            [
                "3c8692d574b1b931"
            ],
            [
                "3c8692d574b1b931"
            ],
            [
                "3c8692d574b1b931"
            ]
        ]
    },
    {
        "id": "3c8692d574b1b931",
        "type": "debug",
        "z": "d452c59951683d0a",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 730,
        "y": 80,
        "wires": []
    },
    {
        "id": "5b4cc8a6a207c41e",
        "type": "inject",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "1",
                "vt": "num"
            }
        ],
        "repeat": "10800",
        "crontab": "",
        "once": true,
        "onceDelay": "30",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 80,
        "wires": [
            [
                "a17ed06224887385"
            ]
        ]
    },
    {
        "id": "a17ed06224887385",
        "type": "http request",
        "z": "fbfe0ebdc384782c",
        "name": "APTA",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.apta.org/search?Q=%22Multiple+Sclerosis%22+OR+%22autoimmune+encephalomyelitis%22+OR+encephalomyelitis+OR+%22immune+tolerance%22+OR+myelin&searcharticletypes=8834&searchconditionandsymptoms=&searchloc=APTA",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 130,
        "y": 140,
        "wires": [
            [
                "03766f3c785ad93c"
            ]
        ]
    },
    {
        "id": "065c06f5634a087c",
        "type": "change",
        "z": "fbfe0ebdc384782c",
        "name": "set source APTA",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "\"https://www.apta.org\" & payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.pubdate",
                "pt": "msg",
                "to": "",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 360,
        "y": 220,
        "wires": [
            [
                "e93313890672aaaa"
            ]
        ]
    },
    {
        "id": "e93313890672aaaa",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "env": [],
        "x": 590,
        "y": 220,
        "wires": [
            [
                "779a3abc3eba4715"
            ]
        ]
    },
    {
        "id": "4ab276e0977c12ba",
        "type": "split",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 510,
        "y": 140,
        "wires": [
            [
                "065c06f5634a087c"
            ]
        ]
    },
    {
        "id": "03766f3c785ad93c",
        "type": "cheerio",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "tag": "div.mg-n40px div.mb-40px",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "a",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "p + p",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "p.text-uppercase.text-muted.ff-apta-sans.fw-600.fs-14px",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 320,
        "y": 140,
        "wires": [
            [
                "4ab276e0977c12ba"
            ]
        ]
    },
    {
        "id": "8e7b15889529f4f4",
        "type": "meta",
        "z": "fbfe0ebdc384782c",
        "name": "meta",
        "x": 250,
        "y": 600,
        "wires": [
            [
                "2eb17ee3869a3ccb"
            ]
        ]
    },
    {
        "id": "5f084f05af68eb63",
        "type": "change",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 520,
        "wires": [
            [
                "8e7b15889529f4f4"
            ]
        ]
    },
    {
        "id": "2eb17ee3869a3ccb",
        "type": "moment",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "topic": "",
        "input": "payload[\"article:published_time\"]",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "POSIX",
        "output": "datetime",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 420,
        "y": 600,
        "wires": [
            [
                "4b9666c990c578ed"
            ]
        ]
    },
    {
        "id": "4b9666c990c578ed",
        "type": "template",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "update articles set published_date ='{{datetime}}' where article_id  = {{article_id}};",
        "output": "str",
        "x": 600,
        "y": 600,
        "wires": [
            [
                "b16686d1c962b161"
            ]
        ]
    },
    {
        "id": "267995acb085440f",
        "type": "comment",
        "z": "fbfe0ebdc384782c",
        "name": "populate missing values of published date",
        "info": "",
        "x": 200,
        "y": 460,
        "wires": []
    },
    {
        "id": "779a3abc3eba4715",
        "type": "postgres",
        "z": "fbfe0ebdc384782c",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 800,
        "y": 220,
        "wires": [
            [
                "268867a5b0b100a8"
            ]
        ]
    },
    {
        "id": "2d3019fc07d3ac5a",
        "type": "inject",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "1",
                "vt": "num"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": true,
        "onceDelay": "180",
        "topic": "",
        "payload": "select article_id,link from articles where source = 1 and published_date is null order by article_id desc limit 10;",
        "payloadType": "str",
        "x": 110,
        "y": 520,
        "wires": [
            [
                "e54489b7e4692638"
            ]
        ]
    },
    {
        "id": "e54489b7e4692638",
        "type": "postgres",
        "z": "fbfe0ebdc384782c",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 240,
        "y": 520,
        "wires": [
            [
                "a4e9f736958acfd4"
            ]
        ]
    },
    {
        "id": "a4e9f736958acfd4",
        "type": "split",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 370,
        "y": 520,
        "wires": [
            [
                "70886bc51fe28e28"
            ]
        ]
    },
    {
        "id": "b16686d1c962b161",
        "type": "postgres",
        "z": "fbfe0ebdc384782c",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 760,
        "y": 600,
        "wires": [
            []
        ]
    },
    {
        "id": "70886bc51fe28e28",
        "type": "delay",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 530,
        "y": 520,
        "wires": [
            [
                "5f084f05af68eb63"
            ]
        ]
    },
    {
        "id": "268867a5b0b100a8",
        "type": "debug",
        "z": "fbfe0ebdc384782c",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 510,
        "y": 360,
        "wires": []
    },
    {
        "id": "ded32c3565228fff",
        "type": "inject",
        "z": "7cb4a59faa141113",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            },
            {
                "p": "source",
                "v": "2",
                "vt": "num"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": true,
        "onceDelay": "30",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 60,
        "wires": [
            [
                "e3a4683ca66fb52c"
            ]
        ]
    },
    {
        "id": "e3a4683ca66fb52c",
        "type": "http request",
        "z": "7cb4a59faa141113",
        "name": "BioMedCentral",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.biomedcentral.com/search?searchType=publisherSearch&sort=PubDate&page=1&query=Multiple+Sclerosis",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 300,
        "y": 60,
        "wires": [
            [
                "9e82b809fcf840ee"
            ]
        ]
    },
    {
        "id": "e8bfa0ad8b138733",
        "type": "change",
        "z": "7cb4a59faa141113",
        "name": "set source BioMedCentral",
        "rules": [
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "\"https:\" & payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.source",
                "pt": "msg",
                "to": "BioMedCentral",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.description",
                "pt": "msg",
                "to": "$trim(article.description)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.title",
                "pt": "msg",
                "to": "$trim(article.title)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 200,
        "wires": [
            [
                "8a4faed03fb7133f"
            ]
        ]
    },
    {
        "id": "dcd533445597851c",
        "type": "split",
        "z": "7cb4a59faa141113",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 370,
        "y": 120,
        "wires": [
            [
                "870f0c26744f2ad9"
            ]
        ]
    },
    {
        "id": "8a4faed03fb7133f",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "7cb4a59faa141113",
        "name": "Insert SQL",
        "env": [],
        "x": 370,
        "y": 260,
        "wires": [
            [
                "bb09fa9ff8315d89"
            ]
        ]
    },
    {
        "id": "9e82b809fcf840ee",
        "type": "cheerio",
        "z": "7cb4a59faa141113",
        "name": "",
        "tag": "li.c-list-group__item",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "h3.c-listing__title",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "a[itemprop=\"url\"]",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "p.c-listing__text",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "span[itemprop=\"datePublished\"]",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 500,
        "y": 60,
        "wires": [
            [
                "dcd533445597851c"
            ]
        ]
    },
    {
        "id": "870f0c26744f2ad9",
        "type": "switch",
        "z": "7cb4a59faa141113",
        "name": "",
        "property": "payload.title",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 490,
        "y": 120,
        "wires": [
            [
                "eabccdc8c2689377"
            ]
        ]
    },
    {
        "id": "eabccdc8c2689377",
        "type": "change",
        "z": "7cb4a59faa141113",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 640,
        "y": 120,
        "wires": [
            [
                "abb572a1fcee3c9a"
            ]
        ]
    },
    {
        "id": "abb572a1fcee3c9a",
        "type": "moment",
        "z": "7cb4a59faa141113",
        "name": "format pubdate",
        "topic": "",
        "input": "payload.pubdate",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "en-US",
        "output": "article.pubdate",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 340,
        "y": 200,
        "wires": [
            [
                "e8bfa0ad8b138733"
            ]
        ]
    },
    {
        "id": "bb09fa9ff8315d89",
        "type": "postgres",
        "z": "7cb4a59faa141113",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 540,
        "y": 260,
        "wires": [
            [
                "280de5f5274a4d6d"
            ]
        ]
    },
    {
        "id": "280de5f5274a4d6d",
        "type": "debug",
        "z": "7cb4a59faa141113",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": true,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 700,
        "y": 260,
        "wires": []
    },
    {
        "id": "6ca4bc9cf9ef1874",
        "type": "http request",
        "z": "aeea6501e40186b3",
        "name": "PEDro",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://search.pedro.org.au/advanced-search/results?abstract_with_title=Multiple+Sclerosis&therapy=0&problem=0&body_part=0&subdiscipline=0&topic=0&method=0&authors_association=&title=&source=&year_of_publication=&date_record_was_created=&nscore=&perpage=20&lop=or&find=&find=Start+Search",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 290,
        "y": 80,
        "wires": [
            [
                "bfc4e86aa16d2aff"
            ]
        ]
    },
    {
        "id": "20609624c4f52855",
        "type": "split",
        "z": "aeea6501e40186b3",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 430,
        "y": 160,
        "wires": [
            [
                "a4e284ba326df0a9"
            ]
        ]
    },
    {
        "id": "5c7a83a8ed482567",
        "type": "change",
        "z": "aeea6501e40186b3",
        "name": "set source PEDro",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.source",
                "pt": "msg",
                "to": "PEDro",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.description",
                "pt": "msg",
                "to": "not available",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.title",
                "pt": "msg",
                "to": "$trim(article.title)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 220,
        "wires": [
            [
                "9d137aea16551bdf"
            ]
        ]
    },
    {
        "id": "9d137aea16551bdf",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "aeea6501e40186b3",
        "name": "Insert SQL",
        "env": [],
        "x": 610,
        "y": 220,
        "wires": [
            [
                "39d23195a734d98f"
            ]
        ]
    },
    {
        "id": "8349b15c6e856988",
        "type": "inject",
        "z": "aeea6501e40186b3",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "7",
                "vt": "num"
            }
        ],
        "repeat": "13200",
        "crontab": "",
        "once": true,
        "onceDelay": "300",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 80,
        "wires": [
            [
                "6ca4bc9cf9ef1874"
            ]
        ]
    },
    {
        "id": "bfc4e86aa16d2aff",
        "type": "cheerio",
        "z": "aeea6501e40186b3",
        "name": "",
        "tag": "table.search-results tr",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "td>a",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "td>a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "p.NoSummary",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "p.NoDate",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 260,
        "y": 160,
        "wires": [
            [
                "20609624c4f52855"
            ]
        ]
    },
    {
        "id": "a4e284ba326df0a9",
        "type": "moment",
        "z": "aeea6501e40186b3",
        "name": "format pubdate",
        "topic": "",
        "input": "payload.pubdate",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "en-US",
        "output": "article.pubdate",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 220,
        "y": 220,
        "wires": [
            [
                "5c7a83a8ed482567"
            ]
        ]
    },
    {
        "id": "9486b3b0e8707d47",
        "type": "inject",
        "z": "aeea6501e40186b3",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "7",
                "vt": "num"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT * FROM articles  WHERE source = 7 AND summary ='not available' ;",
        "payloadType": "str",
        "x": 110,
        "y": 380,
        "wires": [
            [
                "a279f0697d268269"
            ]
        ]
    },
    {
        "id": "7787f23ea85e1aa2",
        "type": "comment",
        "z": "aeea6501e40186b3",
        "name": "ADD PEDro SUMMARY",
        "info": "",
        "x": 160,
        "y": 340,
        "wires": []
    },
    {
        "id": "1d0c57bab91a7c65",
        "type": "split",
        "z": "aeea6501e40186b3",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 410,
        "y": 420,
        "wires": [
            [
                "50170b360e492ebd"
            ]
        ]
    },
    {
        "id": "07e60c04730d19f7",
        "type": "http request",
        "z": "aeea6501e40186b3",
        "name": "PEDro",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 830,
        "y": 420,
        "wires": [
            [
                "46f2cedc759c173a"
            ]
        ]
    },
    {
        "id": "ab968b8c763cae69",
        "type": "change",
        "z": "aeea6501e40186b3",
        "name": "set fields",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "rejectUnauthorized",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 700,
        "y": 420,
        "wires": [
            [
                "07e60c04730d19f7"
            ]
        ]
    },
    {
        "id": "50170b360e492ebd",
        "type": "delay",
        "z": "aeea6501e40186b3",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 550,
        "y": 420,
        "wires": [
            [
                "ab968b8c763cae69"
            ]
        ]
    },
    {
        "id": "ee08bc3cf4604953",
        "type": "split",
        "z": "aeea6501e40186b3",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 390,
        "y": 500,
        "wires": [
            [
                "556ed0c52fa3cc91"
            ]
        ]
    },
    {
        "id": "46f2cedc759c173a",
        "type": "cheerio",
        "z": "aeea6501e40186b3",
        "name": "",
        "tag": "#search-content > table > tbody",
        "ret": "text",
        "as": "single",
        "map": [
            {
                "search": "",
                "ret": "text",
                "replace": "",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": false,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 170,
        "y": 500,
        "wires": [
            [
                "ee08bc3cf4604953"
            ]
        ]
    },
    {
        "id": "39d23195a734d98f",
        "type": "postgres",
        "z": "aeea6501e40186b3",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 760,
        "y": 220,
        "wires": [
            [
                "44e9aa6db539eec0"
            ]
        ]
    },
    {
        "id": "38a92eab1a1e691a",
        "type": "postgres",
        "z": "aeea6501e40186b3",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 260,
        "y": 420,
        "wires": [
            [
                "1d0c57bab91a7c65"
            ]
        ]
    },
    {
        "id": "cf83235e7f5f0d21",
        "type": "postgres",
        "z": "aeea6501e40186b3",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": false,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": false,
        "x": 980,
        "y": 500,
        "wires": []
    },
    {
        "id": "556ed0c52fa3cc91",
        "type": "string",
        "z": "aeea6501e40186b3",
        "name": "",
        "methods": [
            {
                "name": "trim",
                "params": []
            },
            {
                "name": "collapseWhitespace",
                "params": []
            }
        ],
        "prop": "payload",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 510,
        "y": 500,
        "wires": [
            [
                "c29af70ef2c54589"
            ]
        ]
    },
    {
        "id": "c29af70ef2c54589",
        "type": "change",
        "z": "aeea6501e40186b3",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$replace(payload, \"'\", \"''\")\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 670,
        "y": 500,
        "wires": [
            [
                "b64d0da950e809a3"
            ]
        ]
    },
    {
        "id": "b64d0da950e809a3",
        "type": "template",
        "z": "aeea6501e40186b3",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nset summary = '{{{payload}}}'\nwhere article_id = {{article_id}};",
        "output": "str",
        "x": 840,
        "y": 500,
        "wires": [
            [
                "cf83235e7f5f0d21"
            ]
        ]
    },
    {
        "id": "44e9aa6db539eec0",
        "type": "debug",
        "z": "aeea6501e40186b3",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 920,
        "y": 220,
        "wires": []
    },
    {
        "id": "a279f0697d268269",
        "type": "template",
        "z": "aeea6501e40186b3",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "SELECT \"public\".\"articles\".\"article_id\" AS \"article_id\", \"public\".\"articles\".\"title\" AS \"title\", \"public\".\"articles\".\"summary\" AS \"summary\", \"public\".\"articles\".\"link\" AS \"link\", \"public\".\"articles\".\"published_date\" AS \"published_date\", \"public\".\"articles\".\"source\" AS \"source\", \"public\".\"articles\".\"relevant\" AS \"relevant\", \"public\".\"articles\".\"sent_to_admin\" AS \"sent_to_admin\", \"public\".\"articles\".\"ml_prediction_gnb\" AS \"ml_prediction_gnb\", \"public\".\"articles\".\"ml_prediction_lr\" AS \"ml_prediction_lr\", \"public\".\"articles\".\"sent_to_subscribers\" AS \"sent_to_subscribers\", \"public\".\"articles\".\"discovery_date\" AS \"discovery_date\", \"public\".\"articles\".\"sent_to_twitter\" AS \"sent_to_twitter\", \"public\".\"articles\".\"noun_phrases\" AS \"noun_phrases\"\nFROM \"public\".\"articles\"\nWHERE (\"public\".\"articles\".\"summary\" IS NULL\n    OR \"public\".\"articles\".\"summary\" = '') and \"public\".\"articles\".\"source\" = 7\n\n",
        "output": "str",
        "x": 120,
        "y": 420,
        "wires": [
            [
                "38a92eab1a1e691a"
            ]
        ]
    },
    {
        "id": "16c74b04ea56243b",
        "type": "http request",
        "z": "d9d95b7db82b44be",
        "name": "Scielo.org",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://search.scielo.org/?q=Multiple+Sclerosis&lang=en&count=15&from=0&output=site&sort=&format=summary&fb=&page=1&q=%22Multiple+Sclerosis%22+OR+%22autoimmune+encephalomyelitis%22+OR+encephalomyelitis+OR+%22immune+tolerance%22+OR+myelin&lang=en&page=1",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 280,
        "y": 100,
        "wires": [
            [
                "083ae1a1b58a4a41"
            ]
        ]
    },
    {
        "id": "4ca28f31ea6cae54",
        "type": "inject",
        "z": "d9d95b7db82b44be",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "10",
                "vt": "num"
            }
        ],
        "repeat": "14400",
        "crontab": "",
        "once": true,
        "onceDelay": "30",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 100,
        "wires": [
            [
                "16c74b04ea56243b"
            ]
        ]
    },
    {
        "id": "f164da5fa3925368",
        "type": "split",
        "z": "d9d95b7db82b44be",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 650,
        "y": 100,
        "wires": [
            [
                "28ad2bac566388f6"
            ]
        ]
    },
    {
        "id": "a51f984e20faef33",
        "type": "change",
        "z": "d9d95b7db82b44be",
        "name": "set source Scielo",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.source",
                "pt": "msg",
                "to": "Scielo",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.description",
                "pt": "msg",
                "to": "$trim(article.description)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.title",
                "pt": "msg",
                "to": "$trim(article.title)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 160,
        "wires": [
            [
                "9204b64aa8c4492b"
            ]
        ]
    },
    {
        "id": "9204b64aa8c4492b",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "d9d95b7db82b44be",
        "name": "Insert SQL",
        "env": [],
        "x": 510,
        "y": 160,
        "wires": [
            [
                "f0d21fc3bdae08a5"
            ]
        ]
    },
    {
        "id": "083ae1a1b58a4a41",
        "type": "cheerio",
        "z": "d9d95b7db82b44be",
        "name": "",
        "tag": "div.results div.item",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "strong.title",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "div.line a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "p.NoSummary",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "p.NoDate",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 470,
        "y": 100,
        "wires": [
            [
                "f164da5fa3925368"
            ]
        ]
    },
    {
        "id": "28ad2bac566388f6",
        "type": "moment",
        "z": "d9d95b7db82b44be",
        "name": "format pubdate",
        "topic": "",
        "input": "payload.pubdate",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "en-US",
        "output": "article.pubdate",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 140,
        "y": 160,
        "wires": [
            [
                "a51f984e20faef33"
            ]
        ]
    },
    {
        "id": "0857be770f1bbdad",
        "type": "inject",
        "z": "d9d95b7db82b44be",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "10",
                "vt": "num"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT * FROM articles  WHERE source = 10 AND summary ='not available' OR summary is null OR summary = '';",
        "payloadType": "str",
        "x": 130,
        "y": 320,
        "wires": [
            [
                "8ecb9d6ec8fa64e7"
            ]
        ]
    },
    {
        "id": "ed8d431381f046f4",
        "type": "comment",
        "z": "d9d95b7db82b44be",
        "name": "ADD Scielo SUMMARY",
        "info": "",
        "x": 150,
        "y": 280,
        "wires": []
    },
    {
        "id": "0d491f35d51cd040",
        "type": "split",
        "z": "d9d95b7db82b44be",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 690,
        "y": 320,
        "wires": [
            [
                "50e111cc807aa4be"
            ]
        ]
    },
    {
        "id": "f63d6870bd2f82b7",
        "type": "http request",
        "z": "d9d95b7db82b44be",
        "name": "Scielo",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 110,
        "y": 400,
        "wires": [
            [
                "083e26adaa6673bf"
            ]
        ]
    },
    {
        "id": "647d5f2d255e7a1f",
        "type": "change",
        "z": "d9d95b7db82b44be",
        "name": "set fields",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "rejectUnauthorized",
                "pt": "msg",
                "to": "false",
                "tot": "bool"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1000,
        "y": 320,
        "wires": [
            [
                "f63d6870bd2f82b7"
            ]
        ]
    },
    {
        "id": "083e26adaa6673bf",
        "type": "html",
        "z": "d9d95b7db82b44be",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "meta",
        "ret": "attr",
        "as": "multi",
        "x": 240,
        "y": 400,
        "wires": [
            [
                "fe2acbafa53382f9"
            ]
        ]
    },
    {
        "id": "fe2acbafa53382f9",
        "type": "switch",
        "z": "d9d95b7db82b44be",
        "name": "",
        "property": "payload.name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "citation_abstract",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 390,
        "y": 400,
        "wires": [
            [
                "53ef99b338989fea"
            ]
        ]
    },
    {
        "id": "186cdb8de3d342d0",
        "type": "template",
        "z": "d9d95b7db82b44be",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nset summary = '{{{payload.content}}}'\nwhere article_id = {{article_id}};",
        "output": "str",
        "x": 760,
        "y": 400,
        "wires": [
            [
                "fdd98779d3ee6ecc"
            ]
        ]
    },
    {
        "id": "50e111cc807aa4be",
        "type": "delay",
        "z": "d9d95b7db82b44be",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "13",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 840,
        "y": 320,
        "wires": [
            [
                "647d5f2d255e7a1f"
            ]
        ]
    },
    {
        "id": "1916b8ea7d656f6b",
        "type": "debug",
        "z": "d9d95b7db82b44be",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 570,
        "y": 760,
        "wires": []
    },
    {
        "id": "7d5369c36ff1a2af",
        "type": "meta",
        "z": "d9d95b7db82b44be",
        "name": "meta",
        "x": 990,
        "y": 540,
        "wires": [
            [
                "7d5bf28bdcbfe1a3"
            ]
        ]
    },
    {
        "id": "1fb6ccd808217d5e",
        "type": "change",
        "z": "d9d95b7db82b44be",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 820,
        "y": 540,
        "wires": [
            [
                "7d5369c36ff1a2af"
            ]
        ]
    },
    {
        "id": "ecc10206620eecfd",
        "type": "moment",
        "z": "d9d95b7db82b44be",
        "name": "",
        "topic": "",
        "input": "payload.citation_publication_date",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": "0",
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "POSIX",
        "output": "datetime",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 300,
        "y": 620,
        "wires": [
            [
                "ce71281f9a00917c"
            ]
        ]
    },
    {
        "id": "ce71281f9a00917c",
        "type": "template",
        "z": "d9d95b7db82b44be",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "update articles set published_date ='{{datetime}}' where article_id  = {{article_id}};",
        "output": "str",
        "x": 480,
        "y": 620,
        "wires": [
            [
                "1916b8ea7d656f6b",
                "28285f6183cc8235"
            ]
        ]
    },
    {
        "id": "3af3349113dc5323",
        "type": "comment",
        "z": "d9d95b7db82b44be",
        "name": "populate missing values of published date",
        "info": "",
        "x": 220,
        "y": 480,
        "wires": []
    },
    {
        "id": "b5d58352b3464af3",
        "type": "inject",
        "z": "d9d95b7db82b44be",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT \tarticle_id, \tlink FROM \tarticles WHERE \tsource = 10 \tAND published_date IS NULL ORDER BY \tarticle_id DESC LIMIT 10;",
        "payloadType": "str",
        "x": 160,
        "y": 540,
        "wires": [
            [
                "96a066f99627e707"
            ]
        ]
    },
    {
        "id": "7d5bf28bdcbfe1a3",
        "type": "switch",
        "z": "d9d95b7db82b44be",
        "name": "",
        "property": "payload.citation_publication_date",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            },
            {
                "t": "else"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 3,
        "x": 90,
        "y": 620,
        "wires": [
            [
                "ecc10206620eecfd"
            ],
            [
                "1916b8ea7d656f6b"
            ],
            [
                "38475ff80432a228"
            ]
        ]
    },
    {
        "id": "a523665ed44e244f",
        "type": "split",
        "z": "d9d95b7db82b44be",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 450,
        "y": 540,
        "wires": [
            [
                "b273368dd3741e5c"
            ]
        ]
    },
    {
        "id": "b273368dd3741e5c",
        "type": "delay",
        "z": "d9d95b7db82b44be",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "minute",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 620,
        "y": 540,
        "wires": [
            [
                "1fb6ccd808217d5e"
            ]
        ]
    },
    {
        "id": "38475ff80432a228",
        "type": "moment",
        "z": "d9d95b7db82b44be",
        "name": "",
        "topic": "",
        "input": "payload.citation_date",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "POSIX",
        "output": "",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 260,
        "y": 760,
        "wires": [
            [
                "1916b8ea7d656f6b"
            ]
        ]
    },
    {
        "id": "f0d21fc3bdae08a5",
        "type": "postgres",
        "z": "d9d95b7db82b44be",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 700,
        "y": 160,
        "wires": [
            [
                "1f9d3fe354610ce0"
            ]
        ]
    },
    {
        "id": "b9a906dcf5056c64",
        "type": "postgres",
        "z": "d9d95b7db82b44be",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 550,
        "y": 320,
        "wires": [
            [
                "0d491f35d51cd040"
            ]
        ]
    },
    {
        "id": "53ef99b338989fea",
        "type": "change",
        "z": "d9d95b7db82b44be",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.content",
                "pt": "msg",
                "to": "$replace(payload.content, \"'\", \"''\")\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 570,
        "y": 400,
        "wires": [
            [
                "186cdb8de3d342d0"
            ]
        ]
    },
    {
        "id": "fdd98779d3ee6ecc",
        "type": "postgres",
        "z": "d9d95b7db82b44be",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 900,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "96a066f99627e707",
        "type": "postgres",
        "z": "d9d95b7db82b44be",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 300,
        "y": 540,
        "wires": [
            [
                "a523665ed44e244f"
            ]
        ]
    },
    {
        "id": "28285f6183cc8235",
        "type": "postgres",
        "z": "d9d95b7db82b44be",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 680,
        "y": 620,
        "wires": [
            []
        ]
    },
    {
        "id": "1f9d3fe354610ce0",
        "type": "debug",
        "z": "d9d95b7db82b44be",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 880,
        "y": 160,
        "wires": []
    },
    {
        "id": "8ecb9d6ec8fa64e7",
        "type": "template",
        "z": "d9d95b7db82b44be",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "SELECT\n\t\"public\".\"articles\".\"article_id\" AS \"article_id\",\n\t\"public\".\"articles\".\"title\" AS \"title\",\n\t\"public\".\"articles\".\"summary\" AS \"summary\",\n\t\"public\".\"articles\".\"link\" AS \"link\",\n\t\"public\".\"articles\".\"published_date\" AS \"published_date\",\n\t\"public\".\"articles\".\"source\" AS \"source\",\n\t\"public\".\"articles\".\"relevant\" AS \"relevant\",\n\t\"public\".\"articles\".\"sent_to_admin\" AS \"sent_to_admin\",\n\t\"public\".\"articles\".\"ml_prediction_gnb\" AS \"ml_prediction_gnb\",\n\t\"public\".\"articles\".\"ml_prediction_lr\" AS \"ml_prediction_lr\",\n\t\"public\".\"articles\".\"sent_to_subscribers\" AS \"sent_to_subscribers\",\n\t\"public\".\"articles\".\"discovery_date\" AS \"discovery_date\",\n\t\"public\".\"articles\".\"sent_to_twitter\" AS \"sent_to_twitter\",\n\t\"public\".\"articles\".\"noun_phrases\" AS \"noun_phrases\"\nFROM\n\t\"public\".\"articles\"\nWHERE (\"public\".\"articles\".\"summary\" IS NULL\n\tOR \"public\".\"articles\".\"summary\" = '') AND \"source\" = 10;",
        "output": "str",
        "x": 280,
        "y": 320,
        "wires": [
            [
                "b9a906dcf5056c64"
            ]
        ]
    },
    {
        "id": "5ac626db3ff4e0e2",
        "type": "http request",
        "z": "4e972c81ceb89218",
        "name": "The Lancet",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.thelancet.com/action/doSearch?text1=%22Multiple+Sclerosis%22+OR+%22autoimmune+encephalomyelitis%22+OR+encephalomyelitis+OR+%22immune+tolerance%22+OR+myelin&field1=AbstractTitleKeywordFilterField&startPage=0&sortBy=Earliest",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 310,
        "y": 60,
        "wires": [
            [
                "62b4fe6ef6a3b08b"
            ]
        ]
    },
    {
        "id": "58630f8e493b6e27",
        "type": "inject",
        "z": "4e972c81ceb89218",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "11",
                "vt": "num"
            }
        ],
        "repeat": "10800",
        "crontab": "",
        "once": true,
        "onceDelay": "67",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 60,
        "wires": [
            [
                "5ac626db3ff4e0e2"
            ]
        ]
    },
    {
        "id": "9fa5189eb58baf3a",
        "type": "split",
        "z": "4e972c81ceb89218",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 750,
        "y": 60,
        "wires": [
            [
                "a33a097f46044af2"
            ]
        ]
    },
    {
        "id": "a33a097f46044af2",
        "type": "change",
        "z": "4e972c81ceb89218",
        "name": "set source The Lancet",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "\"https://www.thelancet.com\" & payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.source",
                "pt": "msg",
                "to": "The Lancet",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.description",
                "pt": "msg",
                "to": "$trim(article.description)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.title",
                "pt": "msg",
                "to": "$trim(article.title)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.pubdate",
                "pt": "msg",
                "to": "$trim($replace(article.pubdate, \"Published: \", \" \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 60,
        "wires": [
            [
                "3b49fba804e53306"
            ]
        ]
    },
    {
        "id": "754c9033930c78fc",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "4e972c81ceb89218",
        "name": "Insert SQL",
        "env": [],
        "x": 390,
        "y": 140,
        "wires": [
            [
                "e2987f9bbb5e2e06"
            ]
        ]
    },
    {
        "id": "62b4fe6ef6a3b08b",
        "type": "cheerio",
        "z": "4e972c81ceb89218",
        "name": "",
        "tag": "div.search__item__body",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "h4.meta__title",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "h4.meta__title a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "p.NoSummary",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "p.meta__details > span:nth-child(5)",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 550,
        "y": 60,
        "wires": [
            [
                "9fa5189eb58baf3a"
            ]
        ]
    },
    {
        "id": "3b49fba804e53306",
        "type": "moment",
        "z": "4e972c81ceb89218",
        "name": "format pubdate",
        "topic": "",
        "input": "payload.pubdate",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "en-US",
        "output": "article.pubdate",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 180,
        "y": 140,
        "wires": [
            [
                "754c9033930c78fc"
            ]
        ]
    },
    {
        "id": "36c51afaea3bb051",
        "type": "comment",
        "z": "4e972c81ceb89218",
        "name": "ADD The Lancet SUMMARY",
        "info": "",
        "x": 160,
        "y": 360,
        "wires": []
    },
    {
        "id": "cdbd73e1055c51d1",
        "type": "split",
        "z": "4e972c81ceb89218",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 570,
        "y": 460,
        "wires": [
            [
                "5f974a9997cc0375"
            ]
        ]
    },
    {
        "id": "a33c5196ca5555e0",
        "type": "http request",
        "z": "4e972c81ceb89218",
        "name": "The Lancet",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 1030,
        "y": 460,
        "wires": [
            [
                "a0d44014f16be501",
                "0ace08793d06e047"
            ]
        ]
    },
    {
        "id": "a0d44014f16be501",
        "type": "html",
        "z": "4e972c81ceb89218",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "meta",
        "ret": "attr",
        "as": "multi",
        "x": 650,
        "y": 520,
        "wires": [
            [
                "6f3566a185e26cc8"
            ]
        ]
    },
    {
        "id": "93eaa9c3a6e3acad",
        "type": "change",
        "z": "4e972c81ceb89218",
        "name": "set fields",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 880,
        "y": 460,
        "wires": [
            [
                "a33c5196ca5555e0"
            ]
        ]
    },
    {
        "id": "6f3566a185e26cc8",
        "type": "switch",
        "z": "4e972c81ceb89218",
        "name": "",
        "property": "payload.name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "citation_abstract",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 790,
        "y": 520,
        "wires": [
            [
                "1652dc1ce5310899"
            ]
        ]
    },
    {
        "id": "5f974a9997cc0375",
        "type": "delay",
        "z": "4e972c81ceb89218",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "30",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 720,
        "y": 460,
        "wires": [
            [
                "93eaa9c3a6e3acad"
            ]
        ]
    },
    {
        "id": "b317793505c7aee8",
        "type": "change",
        "z": "4e972c81ceb89218",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 140,
        "y": 720,
        "wires": [
            [
                "1760feaa6eb2d6bc"
            ]
        ]
    },
    {
        "id": "4fa06f29b9f04c49",
        "type": "template",
        "z": "4e972c81ceb89218",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "update articles set published_date ='{{payload}}' where article_id  = {{article_id}};",
        "output": "str",
        "x": 440,
        "y": 780,
        "wires": [
            [
                "589e96c954db4745"
            ]
        ]
    },
    {
        "id": "8fb82ce2d5ba4e36",
        "type": "comment",
        "z": "4e972c81ceb89218",
        "name": "populate missing values of published date. working",
        "info": "",
        "x": 230,
        "y": 560,
        "wires": []
    },
    {
        "id": "1760feaa6eb2d6bc",
        "type": "http request",
        "z": "4e972c81ceb89218",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 310,
        "y": 720,
        "wires": [
            [
                "ec1c3cb81b3302c3"
            ]
        ]
    },
    {
        "id": "ec1c3cb81b3302c3",
        "type": "cheerio",
        "z": "4e972c81ceb89218",
        "name": "",
        "tag": "span.article-header__publish-date__value",
        "ret": "html",
        "as": "single",
        "map": [
            {
                "search": "",
                "ret": "text",
                "replace": "published_date",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": false,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 580,
        "y": 720,
        "wires": [
            [
                "a5403439eadceab0"
            ]
        ]
    },
    {
        "id": "a5403439eadceab0",
        "type": "moment",
        "z": "4e972c81ceb89218",
        "name": "",
        "topic": "",
        "input": "payload[0]",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "POSIX",
        "output": "",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 240,
        "y": 780,
        "wires": [
            [
                "4fa06f29b9f04c49"
            ]
        ]
    },
    {
        "id": "e2987f9bbb5e2e06",
        "type": "postgres",
        "z": "4e972c81ceb89218",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 560,
        "y": 140,
        "wires": [
            [
                "b18fbe614c0c97da"
            ]
        ]
    },
    {
        "id": "b18fbe614c0c97da",
        "type": "debug",
        "z": "4e972c81ceb89218",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 710,
        "y": 140,
        "wires": []
    },
    {
        "id": "d461d643987ff0e0",
        "type": "inject",
        "z": "4e972c81ceb89218",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "11",
                "vt": "num"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 110,
        "y": 460,
        "wires": [
            [
                "ca34decd5e586cc4"
            ]
        ]
    },
    {
        "id": "ce7d7cf23cc43b47",
        "type": "postgres",
        "z": "4e972c81ceb89218",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 380,
        "y": 460,
        "wires": [
            [
                "cdbd73e1055c51d1"
            ]
        ]
    },
    {
        "id": "1652dc1ce5310899",
        "type": "template",
        "z": "4e972c81ceb89218",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nset summary = '{{{payload.content}}}'\nwhere article_id = {{article_id}};",
        "output": "str",
        "x": 920,
        "y": 520,
        "wires": [
            [
                "5b4890259355ecb0"
            ]
        ]
    },
    {
        "id": "5b4890259355ecb0",
        "type": "postgres",
        "z": "4e972c81ceb89218",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 1060,
        "y": 520,
        "wires": [
            []
        ]
    },
    {
        "id": "c40031a96fa96a99",
        "type": "inject",
        "z": "4e972c81ceb89218",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT \tarticle_id, \tlink FROM \tarticles WHERE \tsource = 11 \tAND published_date IS NULL ORDER BY \tarticle_id DESC LIMIT 10;",
        "payloadType": "str",
        "x": 130,
        "y": 620,
        "wires": [
            [
                "f1468e3b08df7035"
            ]
        ]
    },
    {
        "id": "f1468e3b08df7035",
        "type": "postgres",
        "z": "4e972c81ceb89218",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 280,
        "y": 620,
        "wires": [
            [
                "e3fa09c531d5324e"
            ]
        ]
    },
    {
        "id": "589e96c954db4745",
        "type": "postgres",
        "z": "4e972c81ceb89218",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": false,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": false,
        "x": 580,
        "y": 780,
        "wires": []
    },
    {
        "id": "728888e1900b9d97",
        "type": "delay",
        "z": "4e972c81ceb89218",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 580,
        "y": 620,
        "wires": [
            [
                "b317793505c7aee8"
            ]
        ]
    },
    {
        "id": "e3fa09c531d5324e",
        "type": "split",
        "z": "4e972c81ceb89218",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 410,
        "y": 620,
        "wires": [
            [
                "728888e1900b9d97"
            ]
        ]
    },
    {
        "id": "ca34decd5e586cc4",
        "type": "template",
        "z": "4e972c81ceb89218",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "SELECT\n\t*\nFROM\n\tarticles\nWHERE\n\tsummary IS NULL\n\tAND source = 11;",
        "output": "str",
        "x": 240,
        "y": 460,
        "wires": [
            [
                "ce7d7cf23cc43b47"
            ]
        ]
    },
    {
        "id": "0ace08793d06e047",
        "type": "debug",
        "z": "4e972c81ceb89218",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 1180,
        "y": 440,
        "wires": []
    },
    {
        "id": "039626468bc32112",
        "type": "http request",
        "z": "ef4efdb19a1e5bd7",
        "name": "JNeuroSci",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.jneurosci.org/search/text_abstract_title%3AMultiple%2BSclerosis%20text_abstract_title_flags%3Amatch-phrase%20exclude_meeting_abstracts%3A1%20numresults%3A50%20sort%3Apublication-date%20direction%3Adescending%20format_result%3Astandard",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 290,
        "y": 60,
        "wires": [
            [
                "e356666273992ab4"
            ]
        ]
    },
    {
        "id": "303a68bba79a02bc",
        "type": "split",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 610,
        "y": 60,
        "wires": [
            [
                "6b19aa32c6323140"
            ]
        ]
    },
    {
        "id": "6b19aa32c6323140",
        "type": "change",
        "z": "ef4efdb19a1e5bd7",
        "name": "set source JNeuroSci",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "\"https://www.jneurosci.org\" & payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.source",
                "pt": "msg",
                "to": "JNeuroSci",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.description",
                "pt": "msg",
                "to": "$trim(article.description)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.title",
                "pt": "msg",
                "to": "$trim(article.title)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.pubdate",
                "pt": "msg",
                "to": "$trim($replace(article.pubdate, \"Published: \", \" \"))",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 800,
        "y": 60,
        "wires": [
            [
                "bac2388b91c13478"
            ]
        ]
    },
    {
        "id": "43fb605d2e520f7b",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "ef4efdb19a1e5bd7",
        "name": "Insert SQL",
        "env": [],
        "x": 350,
        "y": 120,
        "wires": [
            [
                "c20cd969dca2a0dc"
            ]
        ]
    },
    {
        "id": "51e8e5a7e5c118a1",
        "type": "inject",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "4",
                "vt": "num"
            }
        ],
        "repeat": "13800",
        "crontab": "",
        "once": true,
        "onceDelay": "85",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 130,
        "y": 60,
        "wires": [
            [
                "039626468bc32112"
            ]
        ]
    },
    {
        "id": "e356666273992ab4",
        "type": "cheerio",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "tag": "li.search-result",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "a",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "p.NoSummary",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "p.NoDate",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 460,
        "y": 60,
        "wires": [
            [
                "303a68bba79a02bc"
            ]
        ]
    },
    {
        "id": "bac2388b91c13478",
        "type": "moment",
        "z": "ef4efdb19a1e5bd7",
        "name": "format pubdate",
        "topic": "",
        "input": "payload.pubdate",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "en-US",
        "output": "article.pubdate",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 160,
        "y": 120,
        "wires": [
            [
                "43fb605d2e520f7b"
            ]
        ]
    },
    {
        "id": "0c6f992a3c5a21fa",
        "type": "debug",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1700,
        "y": 300,
        "wires": []
    },
    {
        "id": "9fd72db1f3db5c46",
        "type": "comment",
        "z": "ef4efdb19a1e5bd7",
        "name": "ADD JNeuroSci SUMMARY",
        "info": "",
        "x": 180,
        "y": 240,
        "wires": []
    },
    {
        "id": "90d58d715eddcb2f",
        "type": "split",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 410,
        "y": 300,
        "wires": [
            [
                "9cbe2130b8fb505a"
            ]
        ]
    },
    {
        "id": "4a94f12318d9eb62",
        "type": "http request",
        "z": "ef4efdb19a1e5bd7",
        "name": "JNeuroSci",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 630,
        "y": 360,
        "wires": [
            [
                "6475340e72616d90"
            ]
        ]
    },
    {
        "id": "eaf87e474419e220",
        "type": "change",
        "z": "ef4efdb19a1e5bd7",
        "name": "set fields",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 360,
        "wires": [
            [
                "4a94f12318d9eb62"
            ]
        ]
    },
    {
        "id": "6475340e72616d90",
        "type": "html",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "meta",
        "ret": "attr",
        "as": "multi",
        "x": 270,
        "y": 400,
        "wires": [
            [
                "9f74bd3b8d9361ce"
            ]
        ]
    },
    {
        "id": "9f74bd3b8d9361ce",
        "type": "switch",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "property": "payload.name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "citation_abstract",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 410,
        "y": 400,
        "wires": [
            [
                "0fe65a93cac4e795"
            ]
        ]
    },
    {
        "id": "0fe65a93cac4e795",
        "type": "template",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nset summary = '{{{payload.content}}}'\nwhere article_id = {{article_id}};",
        "output": "str",
        "x": 540,
        "y": 400,
        "wires": [
            [
                "f796ffebb8bb5857"
            ]
        ]
    },
    {
        "id": "9cbe2130b8fb505a",
        "type": "delay",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "30",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 300,
        "y": 360,
        "wires": [
            [
                "eaf87e474419e220"
            ]
        ]
    },
    {
        "id": "3ce23c7106fa6d78",
        "type": "meta",
        "z": "ef4efdb19a1e5bd7",
        "name": "meta",
        "x": 470,
        "y": 620,
        "wires": [
            [
                "688974edc2268b38"
            ]
        ]
    },
    {
        "id": "5528798257ebe1fb",
        "type": "change",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 320,
        "y": 620,
        "wires": [
            [
                "3ce23c7106fa6d78"
            ]
        ]
    },
    {
        "id": "688974edc2268b38",
        "type": "moment",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "topic": "",
        "input": "payload.citation_publication_date",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "POSIX",
        "output": "datetime",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 160,
        "y": 700,
        "wires": [
            [
                "16de3d8b5125c6d9"
            ]
        ]
    },
    {
        "id": "16de3d8b5125c6d9",
        "type": "template",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "update articles set published_date ='{{datetime}}' where article_id  = {{article_id}};",
        "output": "str",
        "x": 340,
        "y": 700,
        "wires": [
            [
                "92ba5df59ec0e04d"
            ]
        ]
    },
    {
        "id": "12d588fe9c466e64",
        "type": "comment",
        "z": "ef4efdb19a1e5bd7",
        "name": "populate missing values of published date : working",
        "info": "",
        "x": 250,
        "y": 480,
        "wires": []
    },
    {
        "id": "fb3ae4d6ac19aa08",
        "type": "inject",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "4",
                "vt": "str"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": "137",
        "topic": "",
        "payload": "select article_id,link from articles where source = 4 and published_date is null limit 10;",
        "payloadType": "str",
        "x": 130,
        "y": 540,
        "wires": [
            [
                "745116eca0a8eaec"
            ]
        ]
    },
    {
        "id": "c20cd969dca2a0dc",
        "type": "postgres",
        "z": "ef4efdb19a1e5bd7",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 540,
        "y": 120,
        "wires": [
            [
                "4d175d7b9998c97b"
            ]
        ]
    },
    {
        "id": "ac35739c89026d8a",
        "type": "inject",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": true,
        "onceDelay": "123",
        "topic": "",
        "payload": "SELECT \tarticle_id, \tlink FROM \tarticles WHERE \tsource = 4 \tAND published_date IS NULL ORDER BY \tarticle_id DESC LIMIT 10;",
        "payloadType": "str",
        "x": 130,
        "y": 300,
        "wires": [
            [
                "01e917fae909285d"
            ]
        ]
    },
    {
        "id": "01e917fae909285d",
        "type": "postgres",
        "z": "ef4efdb19a1e5bd7",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 280,
        "y": 300,
        "wires": [
            [
                "90d58d715eddcb2f"
            ]
        ]
    },
    {
        "id": "f796ffebb8bb5857",
        "type": "postgres",
        "z": "ef4efdb19a1e5bd7",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 720,
        "y": 400,
        "wires": [
            []
        ]
    },
    {
        "id": "745116eca0a8eaec",
        "type": "postgres",
        "z": "ef4efdb19a1e5bd7",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 270,
        "y": 540,
        "wires": [
            [
                "d6eb356fc230c772"
            ]
        ]
    },
    {
        "id": "92ba5df59ec0e04d",
        "type": "postgres",
        "z": "ef4efdb19a1e5bd7",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 520,
        "y": 700,
        "wires": [
            []
        ]
    },
    {
        "id": "d6eb356fc230c772",
        "type": "split",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 410,
        "y": 540,
        "wires": [
            [
                "3e2df0b26c223ff1"
            ]
        ]
    },
    {
        "id": "3e2df0b26c223ff1",
        "type": "delay",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "10",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 140,
        "y": 620,
        "wires": [
            [
                "5528798257ebe1fb"
            ]
        ]
    },
    {
        "id": "4d175d7b9998c97b",
        "type": "debug",
        "z": "ef4efdb19a1e5bd7",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 690,
        "y": 120,
        "wires": []
    },
    {
        "id": "c22a488e48d215a7",
        "type": "inject",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "5",
                "vt": "num"
            }
        ],
        "repeat": "13800",
        "crontab": "",
        "once": true,
        "onceDelay": "200",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 166.66665649414062,
        "y": 101.66666412353516,
        "wires": [
            [
                "c40795eb5c087a68"
            ]
        ]
    },
    {
        "id": "c40795eb5c087a68",
        "type": "http request",
        "z": "229c44d5bbf84eb1",
        "name": "MS and Rel. Disorders",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.msard-journal.com/action/doSearch?text1=Multiple+Sclerosis&field1=AbstractTitleKeywordFilterField&startPage=0&sortBy=Earliest",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 386.6666564941406,
        "y": 101.66666412353516,
        "wires": [
            [
                "8725784d152fc0f0"
            ]
        ]
    },
    {
        "id": "c29535e4bd0b786a",
        "type": "split",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 750,
        "y": 100,
        "wires": [
            [
                "cae37559e966fc39"
            ]
        ]
    },
    {
        "id": "cae37559e966fc39",
        "type": "change",
        "z": "229c44d5bbf84eb1",
        "name": "set source MS & rel. disorders",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "\"https://www.msard-journal.com\" & payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.source",
                "pt": "msg",
                "to": "MS & Rel. Disorders",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.description",
                "pt": "msg",
                "to": "not available",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.title",
                "pt": "msg",
                "to": "$trim(article.title)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.pubdate",
                "pt": "msg",
                "to": "$split($trim($replace(article.pubdate, \"Published Online: \", \" \")),\".\",1)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 950,
        "y": 100,
        "wires": [
            [
                "daec510a359a8f0f"
            ]
        ]
    },
    {
        "id": "daec510a359a8f0f",
        "type": "change",
        "z": "229c44d5bbf84eb1",
        "name": "fix pubdate",
        "rules": [
            {
                "t": "set",
                "p": "payload.pubdate",
                "pt": "msg",
                "to": "$replace($replace(payload.pubdate[0],\" \", \"-\"),\",\",\"\")",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 330,
        "y": 160,
        "wires": [
            [
                "26eb1525168a4179"
            ]
        ]
    },
    {
        "id": "c18b56c8350d9e81",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "229c44d5bbf84eb1",
        "name": "Insert SQL",
        "env": [],
        "x": 710,
        "y": 160,
        "wires": [
            [
                "6a4b2b25fc9caa6c"
            ]
        ]
    },
    {
        "id": "8725784d152fc0f0",
        "type": "cheerio",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "tag": "li.search__item",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "h4.meta__title",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "h4.meta__title>a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "div.hlFld-Abstract.preview-abstract",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "p.meta__details > span:nth-child(3)",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 600,
        "y": 100,
        "wires": [
            [
                "c29535e4bd0b786a"
            ]
        ]
    },
    {
        "id": "26eb1525168a4179",
        "type": "moment",
        "z": "229c44d5bbf84eb1",
        "name": "format pubdate",
        "topic": "",
        "input": "payload.pubdate",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "en-US",
        "output": "article.pubdate",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 520,
        "y": 160,
        "wires": [
            [
                "c18b56c8350d9e81"
            ]
        ]
    },
    {
        "id": "656b10c881649b88",
        "type": "comment",
        "z": "229c44d5bbf84eb1",
        "name": "ADD MS & Rel. Disorders SUMMARY",
        "info": "",
        "x": 210,
        "y": 240,
        "wires": []
    },
    {
        "id": "bea6a6b0ce7da242",
        "type": "split",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 390,
        "y": 300,
        "wires": [
            [
                "aa551072b85a081d"
            ]
        ]
    },
    {
        "id": "f47a31e0afae83d5",
        "type": "http request",
        "z": "229c44d5bbf84eb1",
        "name": "MS & Rel. Disorders",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 640,
        "y": 360,
        "wires": [
            [
                "39e049819087ad20"
            ]
        ]
    },
    {
        "id": "39e049819087ad20",
        "type": "html",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "property": "payload",
        "outproperty": "payload",
        "tag": "meta",
        "ret": "attr",
        "as": "multi",
        "x": 810,
        "y": 360,
        "wires": [
            [
                "bc39a0e926541175"
            ]
        ]
    },
    {
        "id": "8f762127f07cd094",
        "type": "change",
        "z": "229c44d5bbf84eb1",
        "name": "set fields",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 460,
        "y": 360,
        "wires": [
            [
                "f47a31e0afae83d5"
            ]
        ]
    },
    {
        "id": "bc39a0e926541175",
        "type": "switch",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "property": "payload.name",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "citation_abstract",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 950,
        "y": 360,
        "wires": [
            [
                "93e107ca4215b3fe"
            ]
        ]
    },
    {
        "id": "bfc122a6867eb2a8",
        "type": "template",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nset summary = '{{{payload.content}}}'\nwhere article_id = {{article_id}};",
        "output": "str",
        "x": 600,
        "y": 420,
        "wires": [
            [
                "75ad5a3290077654"
            ]
        ]
    },
    {
        "id": "1e75c2f9dd2e5bca",
        "type": "inject",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "5",
                "vt": "str"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT * FROM articles  WHERE source = 5 AND summary ='not available' OR summary IS NULL ;",
        "payloadType": "str",
        "x": 120,
        "y": 300,
        "wires": [
            [
                "c9aa0231892c063e"
            ]
        ]
    },
    {
        "id": "aa551072b85a081d",
        "type": "delay",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 300,
        "y": 360,
        "wires": [
            [
                "8f762127f07cd094"
            ]
        ]
    },
    {
        "id": "56f4c89ba2540166",
        "type": "change",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload[0].article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload[0].link",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 340,
        "y": 660,
        "wires": [
            [
                "c52dd5f969ec7110"
            ]
        ]
    },
    {
        "id": "891232a85cb31822",
        "type": "comment",
        "z": "229c44d5bbf84eb1",
        "name": "populate missing values of published date not working",
        "info": "",
        "x": 260,
        "y": 540,
        "wires": []
    },
    {
        "id": "9b9553c093668632",
        "type": "cheerio",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "tag": "span.article-header__publish-date__value",
        "ret": "html",
        "as": "single",
        "map": [
            {
                "search": "",
                "ret": "text",
                "replace": "published_date",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": false,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 380,
        "y": 720,
        "wires": [
            [
                "924ba527a3e1b51b"
            ]
        ]
    },
    {
        "id": "924ba527a3e1b51b",
        "type": "moment",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "topic": "",
        "input": "payload[0]",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "POSIX",
        "output": "",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 200,
        "y": 780,
        "wires": [
            [
                "6134c4eb1d3ecc37"
            ]
        ]
    },
    {
        "id": "6134c4eb1d3ecc37",
        "type": "template",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "update articles set published_date ='{{payload}}' where article_id  = {{article_id}};",
        "output": "str",
        "x": 400,
        "y": 780,
        "wires": [
            [
                "1cec06948586d710"
            ]
        ]
    },
    {
        "id": "1cec06948586d710",
        "type": "debug",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "payload",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 210,
        "y": 840,
        "wires": []
    },
    {
        "id": "c52dd5f969ec7110",
        "type": "http request",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "persist": false,
        "authType": "",
        "senderr": false,
        "x": 130,
        "y": 720,
        "wires": [
            [
                "9b9553c093668632"
            ]
        ]
    },
    {
        "id": "6a4b2b25fc9caa6c",
        "type": "postgres",
        "z": "229c44d5bbf84eb1",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 880,
        "y": 160,
        "wires": [
            [
                "ef6f50d84f41c525"
            ]
        ]
    },
    {
        "id": "c9aa0231892c063e",
        "type": "postgres",
        "z": "229c44d5bbf84eb1",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 260,
        "y": 300,
        "wires": [
            [
                "bea6a6b0ce7da242"
            ]
        ]
    },
    {
        "id": "75ad5a3290077654",
        "type": "postgres",
        "z": "229c44d5bbf84eb1",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 740,
        "y": 420,
        "wires": [
            [
                "95f377f293ef434c"
            ]
        ]
    },
    {
        "id": "8f1aa6fc3a4775f2",
        "type": "inject",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "5",
                "vt": "str"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "select article_id,link from articles where source = \"MS & Rel. Disorders\" and published_date is null order by article_id desc limit 1;",
        "payloadType": "str",
        "x": 130,
        "y": 600,
        "wires": [
            [
                "9746abb39b1d24ff"
            ]
        ]
    },
    {
        "id": "9746abb39b1d24ff",
        "type": "postgres",
        "z": "229c44d5bbf84eb1",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 260,
        "y": 600,
        "wires": [
            [
                "60f7933be1caaa7c"
            ]
        ]
    },
    {
        "id": "60f7933be1caaa7c",
        "type": "split",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 410,
        "y": 600,
        "wires": [
            [
                "8c98ac204ecd894a"
            ]
        ]
    },
    {
        "id": "8c98ac204ecd894a",
        "type": "delay",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "5",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 140,
        "y": 660,
        "wires": [
            [
                "56f4c89ba2540166"
            ]
        ]
    },
    {
        "id": "93e107ca4215b3fe",
        "type": "change",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload.content",
                "pt": "msg",
                "to": "$replace(payload.content, \"'\", \"''\")\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 370,
        "y": 420,
        "wires": [
            [
                "bfc122a6867eb2a8"
            ]
        ]
    },
    {
        "id": "ef6f50d84f41c525",
        "type": "debug",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1050,
        "y": 160,
        "wires": []
    },
    {
        "id": "95f377f293ef434c",
        "type": "debug",
        "z": "229c44d5bbf84eb1",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 870,
        "y": 420,
        "wires": []
    },
    {
        "id": "bf49889256cc6783",
        "type": "http request",
        "z": "02847583794d9f3b",
        "name": "NOVARTIS",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.novartis.com/clinicaltrials/recruiting-trials?title=multiple%20sclerosis",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 370,
        "y": 160,
        "wires": [
            [
                "555696bf1ae29a39"
            ]
        ]
    },
    {
        "id": "07a10d29c3b03559",
        "type": "inject",
        "z": "02847583794d9f3b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "18000",
        "crontab": "",
        "once": true,
        "onceDelay": "200",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 160,
        "wires": [
            [
                "bf49889256cc6783"
            ]
        ]
    },
    {
        "id": "c204ece5aa88ae64",
        "type": "template",
        "z": "02847583794d9f3b",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "INSERT INTO trials (discovery_date, title, summary, link, published_date, source, relevant)\n\t\tVALUES(CURRENT_TIMESTAMP, '{{payload.title}}', NULL, 'https://www.novartis.com/{{{payload.link}}}', NULL, 13, NULL)",
        "output": "str",
        "x": 880,
        "y": 160,
        "wires": [
            [
                "5374561e784d98af"
            ]
        ]
    },
    {
        "id": "5edac0505be73134",
        "type": "split",
        "z": "02847583794d9f3b",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 730,
        "y": 160,
        "wires": [
            [
                "c204ece5aa88ae64"
            ]
        ]
    },
    {
        "id": "609ad472a045a811",
        "type": "http request",
        "z": "02847583794d9f3b",
        "name": "CUF",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://www.cuf.pt/cuf-academic-center/ensaios-clinicos?combine=&unidade=&estado=All&patologia=2346&especialidade=",
        "tls": "",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 350,
        "y": 240,
        "wires": [
            [
                "287c204d9da17fa1"
            ]
        ]
    },
    {
        "id": "99d79d41714d252d",
        "type": "inject",
        "z": "02847583794d9f3b",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "18000",
        "crontab": "",
        "once": true,
        "onceDelay": "42",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 190,
        "y": 240,
        "wires": [
            [
                "609ad472a045a811"
            ]
        ]
    },
    {
        "id": "be6a66a22f99b2d9",
        "type": "template",
        "z": "02847583794d9f3b",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "INSERT INTO trials (discovery_date,title,summary,link,published_date,source,relevant)\nVALUES (current_timestamp,'{{payload.title}}',NULL,'https://www.cuf.pt{{{payload.link}}}',NULL,14,NULL)",
        "output": "str",
        "x": 880,
        "y": 240,
        "wires": [
            [
                "5374561e784d98af"
            ]
        ]
    },
    {
        "id": "f10a85da491f6d72",
        "type": "split",
        "z": "02847583794d9f3b",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 730,
        "y": 240,
        "wires": [
            [
                "be6a66a22f99b2d9"
            ]
        ]
    },
    {
        "id": "35ec9add27d78f73",
        "type": "comment",
        "z": "02847583794d9f3b",
        "name": "Clinical Trials",
        "info": "",
        "x": 130,
        "y": 120,
        "wires": []
    },
    {
        "id": "555696bf1ae29a39",
        "type": "cheerio",
        "z": "02847583794d9f3b",
        "name": "Novartis",
        "tag": "td.views-field",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "a",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "td.views-field.views-field-title>a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 580,
        "y": 160,
        "wires": [
            [
                "5edac0505be73134"
            ]
        ]
    },
    {
        "id": "287c204d9da17fa1",
        "type": "cheerio",
        "z": "02847583794d9f3b",
        "name": "cuf",
        "tag": "div.content",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": ".field--name-title-text",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 570,
        "y": 240,
        "wires": [
            [
                "f10a85da491f6d72"
            ]
        ]
    },
    {
        "id": "5374561e784d98af",
        "type": "postgres",
        "z": "02847583794d9f3b",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": false,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": false,
        "x": 1040,
        "y": 200,
        "wires": []
    },
    {
        "id": "f5e184f95ea778bf",
        "type": "inject",
        "z": "84a5d0feb9217f90",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "172800",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT * FROM articles WHERE sent_to_admin IS NULL OR sent_to_admin =  false; ",
        "payloadType": "str",
        "x": 110,
        "y": 160,
        "wires": [
            [
                "319cdd1f21139e01"
            ]
        ]
    },
    {
        "id": "6a19ea33666e6719",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "email template",
        "field": "text",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<h1>Digest of articles in the last 2 days</h1>\n<br>\n{{#payload}}\n\n\n\n<h2>{{{title}}}</h2>\n\n<p><strong>Discovery Date</strong>: {{discovery_date}}</p>\n\n<ul>\n    <li>ML GNB: {{ml_prediction_gnb}}</li>\n    <li>ML LR: {{ml_prediction_lr}}</li>\n</ul>\n\n<p>\n<a href=\"{{{link}}}\">{{{link}}}</a>\n</p>\n\n<p><a href=\"https://api.gregory-ms.com/articles/id/{{article_id}}/relevant/1\">Mark Relevant</a></p>\n\n<br>\n---\n<br>\n<br>\n{{/payload}}",
        "output": "str",
        "x": 660,
        "y": 160,
        "wires": [
            [
                "89f095a96f0b00b2"
            ]
        ]
    },
    {
        "id": "595294b78dc07c41",
        "type": "http request",
        "z": "84a5d0feb9217f90",
        "name": "http request send mail",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "body",
        "url": "https://api.eu.mailgun.net/v3/mg.gregory-ms.com/messages",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "senderr": false,
        "x": 500,
        "y": 220,
        "wires": [
            [
                "73a9f816915ca506"
            ]
        ]
    },
    {
        "id": "89f095a96f0b00b2",
        "type": "change",
        "z": "84a5d0feb9217f90",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "articles",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"from\":\"Gregory <gregory@mg.gregory-ms.com>\",\"to\":\"admins@mg.gregory-ms.com\",\"subject\":\"Gregory  Admin Summary\",\"multipart\":true}",
                "tot": "json"
            },
            {
                "t": "move",
                "p": "text",
                "pt": "msg",
                "to": "payload.html",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\"content-type\":\"multipart/form-data\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 840,
        "y": 160,
        "wires": [
            [
                "595294b78dc07c41"
            ]
        ]
    },
    {
        "id": "c4e1d94ff017ddc5",
        "type": "comment",
        "z": "84a5d0feb9217f90",
        "name": "Admin summary every 48h",
        "info": "",
        "x": 130,
        "y": 120,
        "wires": []
    },
    {
        "id": "4ad15e793470b467",
        "type": "comment",
        "z": "84a5d0feb9217f90",
        "name": "Weekly summary of relevant articles to the mailing list (Tuesday 8:00)",
        "info": "",
        "x": 260,
        "y": 520,
        "wires": []
    },
    {
        "id": "73a9f816915ca506",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "SQLite template",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nSET sent_to_admin = true\nWHERE article_id IN (\n\n{{#articles}}\n{{article_id}},\n{{/articles}}\n1\n\n);",
        "output": "str",
        "x": 720,
        "y": 220,
        "wires": [
            [
                "f65e5fa307dbea0e"
            ]
        ]
    },
    {
        "id": "527ad9f94abd92ea",
        "type": "switch",
        "z": "84a5d0feb9217f90",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 510,
        "y": 160,
        "wires": [
            [
                "6a19ea33666e6719"
            ]
        ]
    },
    {
        "id": "7dcd0a6b616460be",
        "type": "inject",
        "z": "84a5d0feb9217f90",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "86400",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT *  FROM trials  WHERE sent_to_admin IS NULL OR sent_to_admin = false",
        "payloadType": "str",
        "x": 170,
        "y": 1160,
        "wires": [
            [
                "876169feb52a85bc"
            ]
        ]
    },
    {
        "id": "916d6890845e5c5c",
        "type": "split",
        "z": "84a5d0feb9217f90",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "key",
        "x": 550,
        "y": 1280,
        "wires": [
            [
                "6004edd6092c8faa"
            ]
        ]
    },
    {
        "id": "6004edd6092c8faa",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "SQLite template",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE trials\nSET sent_to_admin = true\nWHERE trial_id = {{payload.trial_id}};",
        "output": "str",
        "x": 980,
        "y": 1280,
        "wires": [
            [
                "79d9e127db920933"
            ]
        ]
    },
    {
        "id": "a048e4cb5d0399f0",
        "type": "comment",
        "z": "84a5d0feb9217f90",
        "name": "Notify admin of new clinical trials",
        "info": "",
        "x": 230,
        "y": 1100,
        "wires": []
    },
    {
        "id": "41ababae49efba15",
        "type": "http request",
        "z": "84a5d0feb9217f90",
        "name": "http request send mail",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "body",
        "url": "https://api.eu.mailgun.net/v3/gregory-ms.com/messages",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "senderr": false,
        "x": 960,
        "y": 1160,
        "wires": [
            [
                "7be6d661422c129d"
            ]
        ]
    },
    {
        "id": "7be6d661422c129d",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "SQLite template",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE trials\nSET sent_to_admin = true\nWHERE trial_id IN (\n\n{{#trials}}\n{{trial_id}},\n{{/trials}}\n1\n\n);",
        "output": "str",
        "x": 980,
        "y": 1220,
        "wires": [
            [
                "79d9e127db920933"
            ]
        ]
    },
    {
        "id": "3f1e2a6dcabdfb27",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "email template",
        "field": "text",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<h1>Digest of trials in the last 2 days</h1>\n<br>\n{{#payload}}\n\n\n<br>\n<h2>{{{title}}}</h2>\n\n<p><strong>Discovery Date</strong>: {{discovery_date}}</p>\n<p>\n<a href=\"{{{link}}}\">{{{link}}}</a>\n</p>\n\n<br>\n---\n<br>\n<br>\n{{/payload}}",
        "output": "str",
        "x": 580,
        "y": 1160,
        "wires": [
            [
                "8dc3196c12acc0db"
            ]
        ]
    },
    {
        "id": "fa78f9a9e9439b45",
        "type": "switch",
        "z": "84a5d0feb9217f90",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 390,
        "y": 1200,
        "wires": [
            [
                "3f1e2a6dcabdfb27",
                "916d6890845e5c5c"
            ],
            []
        ]
    },
    {
        "id": "8dc3196c12acc0db",
        "type": "change",
        "z": "84a5d0feb9217f90",
        "name": "",
        "rules": [
            {
                "t": "delete",
                "p": "payload",
                "pt": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"from\":\"gregory@mg.brunoamaral.net\",\"to\":\"labs@mg.brunoamaral.net\",\"subject\":\"Gregory  Admin Summary\",\"multipart\":true}",
                "tot": "json"
            },
            {
                "t": "move",
                "p": "text",
                "pt": "msg",
                "to": "payload.html",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 760,
        "y": 1160,
        "wires": [
            [
                "41ababae49efba15"
            ]
        ]
    },
    {
        "id": "ff1a65b6d44e1394",
        "type": "comment",
        "z": "84a5d0feb9217f90",
        "name": "SETUP INSTRUCTIONS",
        "info": "Emails are sent using mailgun, you should sign up for an account or use these flows as an example.",
        "x": 130,
        "y": 40,
        "wires": []
    },
    {
        "id": "89da2e197c3414b4",
        "type": "inject",
        "z": "84a5d0feb9217f90",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "00 08 * * 2",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 110,
        "y": 580,
        "wires": [
            [
                "5814c96a5b8ce6a3",
                "20d901a7d545d6a7"
            ]
        ]
    },
    {
        "id": "5814c96a5b8ce6a3",
        "type": "change",
        "z": "84a5d0feb9217f90",
        "name": "Set path = articles",
        "rules": [
            {
                "t": "set",
                "p": "paths",
                "pt": "msg",
                "to": "articles",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "SELECT * FROM articles WHERE sent_to_subscribers IS NULL OR sent_to_subscribers = FALSE     AND relevant = 1;",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 350,
        "y": 580,
        "wires": [
            [
                "cf7d762095f6e582"
            ]
        ]
    },
    {
        "id": "20d901a7d545d6a7",
        "type": "change",
        "z": "84a5d0feb9217f90",
        "name": "Set path = trials",
        "rules": [
            {
                "t": "set",
                "p": "paths",
                "pt": "msg",
                "to": "trials",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "SELECT *  FROM trials  WHERE sent_to_subscribers IS NULL OR sent_to_subscribers = FALSE ;",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 200,
        "y": 720,
        "wires": [
            [
                "a58c2ef5f5d433c4"
            ]
        ]
    },
    {
        "id": "2fcca7807339243d",
        "type": "switch",
        "z": "84a5d0feb9217f90",
        "name": "check if empty",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 560,
        "y": 640,
        "wires": [
            [
                "ac7ab02f2419e1b8"
            ],
            []
        ]
    },
    {
        "id": "63726d3508e1748e",
        "type": "switch",
        "z": "84a5d0feb9217f90",
        "name": "if not empty",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 450,
        "y": 760,
        "wires": [
            [
                "ac7ab02f2419e1b8"
            ],
            [
                "ac7ab02f2419e1b8"
            ]
        ]
    },
    {
        "id": "ac7ab02f2419e1b8",
        "type": "join-wait",
        "z": "84a5d0feb9217f90",
        "name": "",
        "paths": "[\"articles\", \"trials\"]",
        "pathsToExpire": "",
        "useRegex": false,
        "warnUnmatched": false,
        "pathTopic": "paths",
        "pathTopicType": "msg",
        "correlationTopic": "",
        "correlationTopicType": "msg",
        "timeout": "5",
        "timeoutUnits": "1000",
        "exactOrder": "false",
        "firstMsg": "true",
        "mapPayload": "true",
        "disableComplete": false,
        "persistOnRestart": false,
        "x": 720,
        "y": 760,
        "wires": [
            [
                "1ba4311cedba4806"
            ],
            []
        ]
    },
    {
        "id": "1ba4311cedba4806",
        "type": "change",
        "z": "84a5d0feb9217f90",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "paths.articles",
                "pt": "msg",
                "to": "articles",
                "tot": "msg"
            },
            {
                "t": "move",
                "p": "paths.trials",
                "pt": "msg",
                "to": "trials",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 880,
        "y": 760,
        "wires": [
            [
                "4c2e087c4f22bbeb"
            ]
        ]
    },
    {
        "id": "4c2e087c4f22bbeb",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "email template",
        "field": "text",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "<!doctype html>\n<html>\n  <head>\n    <meta name=\"viewport\" content=\"width=device-width, initial-scale=1.0\">\n    <meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\">\n    <title>Gregory MS update</title>\n    <style>\n@media only screen and (max-width: 620px) {\n  table.body h1 {\n    font-size: 28px !important;\n    margin-bottom: 10px !important;\n  }\n\n  table.body p,\ntable.body ul,\ntable.body ol,\ntable.body td,\ntable.body span,\ntable.body a {\n    font-size: 16px !important;\n  }\n\n  table.body .wrapper,\ntable.body .article {\n    padding: 10px !important;\n  }\n\n  table.body .content {\n    padding: 0 !important;\n  }\n\n  table.body .container {\n    padding: 0 !important;\n    width: 100% !important;\n  }\n\n  table.body .main {\n    border-left-width: 0 !important;\n    border-radius: 0 !important;\n    border-right-width: 0 !important;\n  }\n\n  table.body .btn table {\n    width: 100% !important;\n  }\n\n  table.body .btn a {\n    width: 100% !important;\n  }\n\n  table.body .img-responsive {\n    height: auto !important;\n    max-width: 100% !important;\n    width: auto !important;\n  }\n}\n@media all {\n  .ExternalClass {\n    width: 100%;\n  }\n\n  .ExternalClass,\n.ExternalClass p,\n.ExternalClass span,\n.ExternalClass font,\n.ExternalClass td,\n.ExternalClass div {\n    line-height: 100%;\n  }\n\n  .apple-link a {\n    color: inherit !important;\n    font-family: inherit !important;\n    font-size: inherit !important;\n    font-weight: inherit !important;\n    line-height: inherit !important;\n    text-decoration: none !important;\n  }\n\n  #MessageViewBody a {\n    color: inherit;\n    text-decoration: none;\n    font-size: inherit;\n    font-family: inherit;\n    font-weight: inherit;\n    line-height: inherit;\n  }\n\n  .btn-primary table td:hover {\n    background-color: #34495e !important;\n  }\n\n  .btn-primary a:hover {\n    background-color: #34495e !important;\n    border-color: #34495e !important;\n  }\n}\n</style>\n  </head>\n  <body class=\"\" style=\"background-color: #f6f6f6; font-family: sans-serif; -webkit-font-smoothing: antialiased; font-size: 14px; line-height: 1.4; margin: 0; padding: 0; -ms-text-size-adjust: 100%; -webkit-text-size-adjust: 100%;\">\n    <span class=\"preheader\" style=\"color: transparent; display: none; height: 0; max-height: 0; max-width: 0; opacity: 0; overflow: hidden; mso-hide: all; visibility: hidden; width: 0;\">List of articles and new trials this week.</span>\n    <table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" class=\"body\" style=\"border-collapse: separate; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background-color: #f6f6f6; width: 100%;\" width=\"100%\" bgcolor=\"#f6f6f6\">\n      <tr>\n        <td style=\"font-family: sans-serif; font-size: 14px; vertical-align: top;\" valign=\"top\">&nbsp;</td>\n        <td class=\"container\" style=\"font-family: sans-serif; font-size: 14px; vertical-align: top; display: block; max-width: 580px; padding: 10px; width: 580px; margin: 0 auto;\" width=\"580\" valign=\"top\">\n          <div class=\"content\" style=\"box-sizing: border-box; display: block; margin: 0 auto; max-width: 580px; padding: 10px;\">\n\n            <!-- START CENTERED WHITE CONTAINER -->\n            <table role=\"presentation\" class=\"main\" style=\"border-collapse: separate; mso-table-lspace: 0pt; mso-table-rspace: 0pt; background: #ffffff; border-radius: 3px; width: 100%;\" width=\"100%\">\n\n              <!-- START MAIN CONTENT AREA -->\n              <tr>\n                <td class=\"wrapper\" style=\"font-family: sans-serif; font-size: 14px; vertical-align: top; box-sizing: border-box; padding: 20px;\" valign=\"top\">\n                  <table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: separate; mso-table-lspace: 0pt; mso-table-rspace: 0pt; width: 100%;\" width=\"100%\">\n                    <tr>\n                      <td style=\"font-family: sans-serif; font-size: 14px; vertical-align: top;\" valign=\"top\">\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">Good Morning, %recipient_fname%, </p>\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">Here are the relevant articles we have found in the last 7 days</p>\n\n                        <h2 style=\"color: #0f74c0; font-family: sans-serif; font-weight: 700; line-height: 1.4; margin: 0; margin-bottom: 30px;\">New Articles</h2>\n                        {{#articles}}\n\n                        <h2 style=\"color: #000000; font-family: sans-serif; font-weight: 400; line-height: 1.4; margin: 0; margin-bottom: 30px;\">{{{title}}}</h2>\n\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\"><strong>Discovery Date</strong>: {{discovery_date}}</p>\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">\n                        <a href=\"{{{link}}}\" style=\"color: #3498db; text-decoration: underline;\">{{{link}}}</a>\n                        </p>\n\n                        <hr>\n\n                        {{/articles}}\n\n                        <h2 style=\"color: #0f74c0; font-family: sans-serif; font-weight: 700; line-height: 1.4; margin: 0; margin-bottom: 30px;\">New Trials</h2>\n\n                        {{#trials}}\n\n                        <h2 style=\"color: #000000; font-family: sans-serif; font-weight: 400; line-height: 1.4; margin: 0; margin-bottom: 30px;\">{{{title}}}</h2>\n\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\"><strong>Discovery Date</strong>: {{discovery_date}}</p>\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">\n                        <a href=\"{{link}}\" style=\"color: #3498db; text-decoration: underline;\">{{{link}}}</a>\n                        </p>\n\n                        <hr>\n\n                        {{/trials}}\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">For the full list, please visit <a href=\"https://gregory-ms.com/\" style=\"color: #3498db; text-decoration: underline;\">https://gregory-ms.com/</a></p>\n\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">For adding people to this email list or further information, please contact Bruno Amaral:</p>\n\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\"><strong>Mobile</strong>: +351 912 875 856</p>\n\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\"><strong>Email</strong>: mail@brunoamaral.eu</p>\n\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">If you wish to unsubscribe, follow the link below.</p>\n\n                        <p style=\"font-family: sans-serif; font-size: 14px; font-weight: normal; margin: 0; margin-bottom: 15px;\">Best wishes fomyour friendly research bot.<br><strong>Gregory</strong></p>\n\n                      </td>\n                    </tr>\n                  </table>\n                </td>\n              </tr>\n\n            <!-- END MAIN CONTENT AREA -->\n            </table>\n            <!-- END CENTERED WHITE CONTAINER -->\n\n            <!-- START FOOTER -->\n            <div class=\"footer\" style=\"clear: both; margin-top: 10px; text-align: center; width: 100%;\">\n              <table role=\"presentation\" border=\"0\" cellpadding=\"0\" cellspacing=\"0\" style=\"border-collapse: separate; mso-table-lspace: 0pt; mso-table-rspace: 0pt; width: 100%;\" width=\"100%\">\n                <tr>\n                  <td class=\"content-block\" style=\"font-family: sans-serif; vertical-align: top; padding-bottom: 10px; padding-top: 10px; color: #999999; font-size: 12px; text-align: center;\" valign=\"top\" align=\"center\">\n                    <span class=\"apple-link\" style=\"color: #999999; font-size: 12px; text-align: center;\">Gregory MS</span>\n                    <br> For more information visit <a href=\"https://gregory-ms.com/\" style=\"text-decoration: underline; color: #999999; font-size: 12px; text-align: center;\">https://gregory-ms.com/</a>.\n                  </td>\n                </tr>\n                <tr>\n                  <td class=\"content-block powered-by\" style=\"font-family: sans-serif; vertical-align: top; padding-bottom: 10px; padding-top: 10px; color: #999999; font-size: 12px; text-align: center;\" valign=\"top\" align=\"center\">\n                    Powered by <a href=\"http://htmlemail.io\" style=\"color: #999999; font-size: 12px; text-align: center; text-decoration: none;\">HTMLemail</a>.\n                  </td>\n                </tr>\n              </table>\n            </div>\n            <!-- END FOOTER -->\n\n          </div>\n        </td>\n        <td style=\"font-family: sans-serif; font-size: 14px; vertical-align: top;\" valign=\"top\">&nbsp;</td>\n      </tr>\n    </table>\n  </body>\n</html>",
        "output": "str",
        "x": 780,
        "y": 820,
        "wires": [
            [
                "c76f92c8148a53df"
            ]
        ]
    },
    {
        "id": "2703915efe3190fa",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nSET sent_to_subscribers = true\nWHERE article_id IN (\n\n{{#articles}}\n{{article_id}},\n{{/articles}}\n1\n\n);\n\nUPDATE trials\nSET sent_to_subscribers = true\nWHERE trial_id IN (\n\n{{#trials}}\n{{trial_id}},\n{{/trials}}\n1\n\n);",
        "output": "str",
        "x": 780,
        "y": 920,
        "wires": [
            [
                "d7d4fe38ce224169"
            ]
        ]
    },
    {
        "id": "c76f92c8148a53df",
        "type": "change",
        "z": "84a5d0feb9217f90",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload",
                "pt": "msg",
                "to": "oldpayload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "{\"from\":\"Gregory <gregory@mg.gregory-ms.com>\",\"to\":\"subscribers@mg.gregory-ms.com\",\"subject\":\"Gregory  Weekly Summary\",\"multipart\":true}",
                "tot": "json"
            },
            {
                "t": "move",
                "p": "text",
                "pt": "msg",
                "to": "payload.html",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "headers",
                "pt": "msg",
                "to": "{\"content-type\":\"multipart/form-data\"}",
                "tot": "json"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 980,
        "y": 820,
        "wires": [
            [
                "3de64bbd1469dc15"
            ]
        ]
    },
    {
        "id": "3de64bbd1469dc15",
        "type": "http request",
        "z": "84a5d0feb9217f90",
        "name": "",
        "method": "POST",
        "ret": "obj",
        "paytoqs": "body",
        "url": "https://api.eu.mailgun.net/v3/mg.gregory-ms.com/messages",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "basic",
        "senderr": false,
        "x": 790,
        "y": 860,
        "wires": [
            [
                "a371fcac74f20bb3"
            ]
        ]
    },
    {
        "id": "a371fcac74f20bb3",
        "type": "switch",
        "z": "84a5d0feb9217f90",
        "name": "statusCode=200?",
        "property": "statusCode",
        "propertyType": "msg",
        "rules": [
            {
                "t": "eq",
                "v": "200",
                "vt": "num"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 970,
        "y": 860,
        "wires": [
            [
                "2703915efe3190fa"
            ]
        ]
    },
    {
        "id": "2c2931a70de6f28d",
        "type": "postgres",
        "z": "84a5d0feb9217f90",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 380,
        "y": 160,
        "wires": [
            [
                "527ad9f94abd92ea"
            ]
        ]
    },
    {
        "id": "cf7d762095f6e582",
        "type": "postgres",
        "z": "84a5d0feb9217f90",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 400,
        "y": 640,
        "wires": [
            [
                "2fcca7807339243d"
            ]
        ]
    },
    {
        "id": "526cdec14bbffc6b",
        "type": "postgres",
        "z": "84a5d0feb9217f90",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 300,
        "y": 760,
        "wires": [
            [
                "63726d3508e1748e"
            ]
        ]
    },
    {
        "id": "d7d4fe38ce224169",
        "type": "postgres",
        "z": "84a5d0feb9217f90",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 960,
        "y": 920,
        "wires": [
            []
        ]
    },
    {
        "id": "876169feb52a85bc",
        "type": "postgres",
        "z": "84a5d0feb9217f90",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 260,
        "y": 1200,
        "wires": [
            [
                "fa78f9a9e9439b45"
            ]
        ]
    },
    {
        "id": "f65e5fa307dbea0e",
        "type": "postgres",
        "z": "84a5d0feb9217f90",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 880,
        "y": 220,
        "wires": [
            [
                "ba4ef4a418930976"
            ]
        ]
    },
    {
        "id": "ba4ef4a418930976",
        "type": "debug",
        "z": "84a5d0feb9217f90",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 300,
        "wires": []
    },
    {
        "id": "319cdd1f21139e01",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "SELECT * FROM articles WHERE sent_to_admin IS NULL OR sent_to_admin =  false; ",
        "output": "str",
        "x": 240,
        "y": 160,
        "wires": [
            [
                "2c2931a70de6f28d"
            ]
        ]
    },
    {
        "id": "a58c2ef5f5d433c4",
        "type": "template",
        "z": "84a5d0feb9217f90",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "SELECT\n\t*\nFROM\n\ttrials\nWHERE\n\tsent_to_subscribers IS NULL\n\tOR sent_to_subscribers = FALSE\n\tAND discovery_date > CURRENT_DATE - interval '7 days'",
        "output": "str",
        "x": 160,
        "y": 760,
        "wires": [
            [
                "526cdec14bbffc6b"
            ]
        ]
    },
    {
        "id": "79d9e127db920933",
        "type": "postgres",
        "z": "84a5d0feb9217f90",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 1160,
        "y": 1240,
        "wires": [
            []
        ]
    },
    {
        "id": "0d5d92fe67078174",
        "type": "inject",
        "z": "8950ec157392345e",
        "name": "GO!",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "1200",
        "crontab": "",
        "once": true,
        "onceDelay": "600",
        "topic": "",
        "payload": "https://api.gregory-ms.com/articles/prediction/none",
        "payloadType": "str",
        "x": 90,
        "y": 160,
        "wires": [
            [
                "b360d75d4652797a"
            ]
        ]
    },
    {
        "id": "10168203e2ea8dd2",
        "type": "json",
        "z": "8950ec157392345e",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1030,
        "y": 240,
        "wires": [
            [
                "2867e9a54b2143ec"
            ]
        ]
    },
    {
        "id": "2867e9a54b2143ec",
        "type": "template",
        "z": "8950ec157392345e",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "{{#payload.models.gnb}}\nUPDATE articles SET ml_prediction_gnb = {{prediction}} WHERE article_id = {{article_id}};\n{{/payload.models.gnb}}\n\n{{#payload.models.lr}}\nUPDATE articles SET ml_prediction_lr = {{prediction}} WHERE article_id = {{article_id}};\n{{/payload.models.lr}}",
        "output": "str",
        "x": 760,
        "y": 300,
        "wires": [
            [
                "10e5748177d0c296"
            ]
        ]
    },
    {
        "id": "7574734d78dad5ef",
        "type": "exec",
        "z": "8950ec157392345e",
        "command": "/usr/bin/python3 /python-ml/3_predict.py ",
        "addpay": "responseUrl",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 800,
        "y": 220,
        "wires": [
            [
                "10168203e2ea8dd2"
            ],
            [],
            []
        ]
    },
    {
        "id": "b360d75d4652797a",
        "type": "http request",
        "z": "8950ec157392345e",
        "name": "get articles to run predictions",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://api.gregory-ms.com/articles/prediction/none",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 280,
        "y": 160,
        "wires": [
            [
                "3e45be64d91c22e0"
            ]
        ]
    },
    {
        "id": "c3cfc9d10df5f89a",
        "type": "switch",
        "z": "8950ec157392345e",
        "name": "check for resullts",
        "property": "payload.count",
        "propertyType": "msg",
        "rules": [
            {
                "t": "neq",
                "v": "0",
                "vt": "str"
            },
            {
                "t": "eq",
                "v": "0",
                "vt": "str"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 510,
        "y": 260,
        "wires": [
            [
                "7574734d78dad5ef"
            ],
            []
        ]
    },
    {
        "id": "3fee5ebe107b156e",
        "type": "rss",
        "z": "8950ec157392345e",
        "name": "",
        "feedOptionRules": [
            {
                "name": "title",
                "type": "str",
                "value": "Gregory"
            },
            {
                "name": "site_url",
                "type": "str",
                "value": "https://gregory-ms.com/"
            },
            {
                "name": "feed_url",
                "type": "str",
                "value": "https://api.gregory-ms.com/machine-learning/feed"
            }
        ],
        "itemOptionRules": [
            {
                "name": "custom_elements.id",
                "type": "item",
                "value": "article_id"
            },
            {
                "name": "title",
                "type": "item",
                "value": "title"
            },
            {
                "name": "url",
                "type": "item",
                "value": "link"
            },
            {
                "name": "description",
                "type": "item",
                "value": "summary"
            },
            {
                "name": "date",
                "type": "item",
                "value": "discovery_date"
            },
            {
                "name": "guid",
                "type": "item",
                "value": "article_id"
            }
        ],
        "x": 710,
        "y": 420,
        "wires": [
            [
                "855cf6d208dc5df4"
            ]
        ]
    },
    {
        "id": "9873007ab30910de",
        "type": "http in",
        "z": "8950ec157392345e",
        "name": "",
        "url": "/machine-learning/feed",
        "method": "get",
        "upload": false,
        "swaggerDoc": "",
        "x": 160,
        "y": 420,
        "wires": [
            [
                "c9c4277138be4d26"
            ]
        ]
    },
    {
        "id": "855cf6d208dc5df4",
        "type": "http response",
        "z": "8950ec157392345e",
        "name": "",
        "statusCode": "200",
        "headers": {
            "content-type": "application/rss+xml"
        },
        "x": 840,
        "y": 420,
        "wires": []
    },
    {
        "id": "a2b437885675cb51",
        "type": "http request",
        "z": "8950ec157392345e",
        "name": "get all articles",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://api.gregory-ms.com/articles/all",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 280,
        "y": 260,
        "wires": [
            [
                "c3cfc9d10df5f89a"
            ]
        ]
    },
    {
        "id": "8b4e2a39c8087f21",
        "type": "inject",
        "z": "8950ec157392345e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 120,
        "y": 260,
        "wires": [
            [
                "a2b437885675cb51"
            ]
        ]
    },
    {
        "id": "cbdd4e4b236e4da3",
        "type": "exec",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "command": "/usr/bin/python3 /python-ml/noun_phrases.py",
        "addpay": "title",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 300,
        "y": 820,
        "wires": [
            [
                "4398218e763bce5a"
            ],
            [],
            []
        ]
    },
    {
        "id": "5ddb96550ba669fc",
        "type": "inject",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "3600",
        "crontab": "",
        "once": true,
        "onceDelay": "666",
        "topic": "",
        "payloadType": "date",
        "x": 130,
        "y": 560,
        "wires": [
            [
                "c9797ce85aee3357"
            ]
        ]
    },
    {
        "id": "66f41ac3333740a9",
        "type": "change",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "title",
                "pt": "msg",
                "to": "payload[0].title",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload[0].article_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 300,
        "y": 720,
        "wires": [
            [
                "d3a6e1792df3a8c5"
            ]
        ]
    },
    {
        "id": "d3a6e1792df3a8c5",
        "type": "template",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "field": "title",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "\"{{{title}}}\"",
        "output": "str",
        "x": 160,
        "y": 760,
        "wires": [
            [
                "cbdd4e4b236e4da3"
            ]
        ]
    },
    {
        "id": "61a4dc47f3f813d8",
        "type": "template",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "update articles set noun_phrases = '{{{payload}}}' where article_id = {{article_id}};",
        "output": "str",
        "x": 600,
        "y": 840,
        "wires": [
            [
                "1fc6d688700df5e6"
            ]
        ]
    },
    {
        "id": "4398218e763bce5a",
        "type": "change",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$trim(payload)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 600,
        "y": 800,
        "wires": [
            [
                "61a4dc47f3f813d8"
            ]
        ]
    },
    {
        "id": "7ad6c1619dcbcd0a",
        "type": "comment",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "identify noun phrases",
        "info": "",
        "x": 840,
        "y": 560,
        "wires": []
    },
    {
        "id": "f9cde35485011e98",
        "type": "delay",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "pauseType": "delay",
        "timeout": "500",
        "timeoutUnits": "milliseconds",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 610,
        "y": 580,
        "wires": [
            [
                "c9797ce85aee3357"
            ]
        ]
    },
    {
        "id": "ed5b8ee5804626d4",
        "type": "switch",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 1,
        "x": 150,
        "y": 720,
        "wires": [
            [
                "66f41ac3333740a9"
            ]
        ]
    },
    {
        "id": "75b6193a8ebee937",
        "type": "inject",
        "z": "8950ec157392345e",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "259200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payloadType": "date",
        "x": 110,
        "y": 980,
        "wires": [
            [
                "3f91774510870b72"
            ]
        ]
    },
    {
        "id": "3f91774510870b72",
        "type": "exec",
        "z": "8950ec157392345e",
        "command": "/usr/bin/python3 /python-ml/1_data_processor.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 390,
        "y": 980,
        "wires": [
            [
                "c8a592b40eae2c54"
            ],
            [],
            []
        ]
    },
    {
        "id": "c8a592b40eae2c54",
        "type": "exec",
        "z": "8950ec157392345e",
        "command": "/usr/bin/python3 /python-ml/2_train_models.py",
        "addpay": "",
        "append": "",
        "useSpawn": "false",
        "timer": "",
        "winHide": false,
        "oldrc": false,
        "name": "",
        "x": 800,
        "y": 980,
        "wires": [
            [],
            [],
            []
        ]
    },
    {
        "id": "97ec9f3fc4910fe6",
        "type": "comment",
        "z": "8950ec157392345e",
        "name": "retrain models every 72h",
        "info": "",
        "x": 140,
        "y": 940,
        "wires": []
    },
    {
        "id": "017d8cbed06d6613",
        "type": "postgres",
        "z": "8950ec157392345e",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 560,
        "y": 420,
        "wires": [
            [
                "3fee5ebe107b156e"
            ]
        ]
    },
    {
        "id": "c9797ce85aee3357",
        "type": "change",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "select title,article_id from articles where noun_phrases IS NULL limit 1;",
                "tot": "str"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 210,
        "y": 640,
        "wires": [
            [
                "e0b8f9989ee565b1"
            ]
        ]
    },
    {
        "id": "e0b8f9989ee565b1",
        "type": "postgres",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 190,
        "y": 680,
        "wires": [
            [
                "ed5b8ee5804626d4"
            ]
        ]
    },
    {
        "id": "1fc6d688700df5e6",
        "type": "postgres",
        "z": "8950ec157392345e",
        "g": "27183810297269c1",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 780,
        "y": 840,
        "wires": [
            [
                "f9cde35485011e98"
            ]
        ]
    },
    {
        "id": "be5b216fbcd4acaa",
        "type": "postgres",
        "z": "8950ec157392345e",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 1100,
        "y": 300,
        "wires": [
            [
                "d7dfd61e7e28ee64"
            ]
        ]
    },
    {
        "id": "10e5748177d0c296",
        "type": "change",
        "z": "8950ec157392345e",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "$replace($replace(payload, '= 1', '= true'), '= 0', '= false')\t",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 930,
        "y": 300,
        "wires": [
            [
                "be5b216fbcd4acaa"
            ]
        ]
    },
    {
        "id": "d7dfd61e7e28ee64",
        "type": "debug",
        "z": "8950ec157392345e",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 950,
        "y": 340,
        "wires": []
    },
    {
        "id": "3e45be64d91c22e0",
        "type": "json",
        "z": "8950ec157392345e",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 470,
        "y": 160,
        "wires": [
            [
                "c3cfc9d10df5f89a"
            ]
        ]
    },
    {
        "id": "c9c4277138be4d26",
        "type": "template",
        "z": "8950ec157392345e",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": " select * from articles where ml_prediction_gnb = true order by article_id desc limit 10;",
        "output": "str",
        "x": 360,
        "y": 420,
        "wires": [
            [
                "017d8cbed06d6613"
            ]
        ]
    },
    {
        "id": "45097a07633b6b70",
        "type": "function",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "Prepare Notion DB payload",
        "func": "var data = msg.payload[0]\nvar title = msg.payload[0].title\nvar url = msg.payload[0].link\n\n\n\nvar postData = {\n\t\"parent\": { \"database_id\": \"4fa1dc37-a3bf-43be-9c8d-35b41e539f8d\" },\n\t\"properties\": {\n\t\t\"Name\": {\n\t\t\t\"title\": [\n\t\t\t\t{\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"content\": title\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t},\n\t\t\"Status\": {\n\t\t    \"select\": {\n\t\t        \"name\": \"Auto\"\n\t\t    }\n\t\t},\n        \"Link\": {\n            \"url\": url\n        }\n\t\t\n}}\n\n\n\n//\t\t\"Context\": {\n//\t\t\t\"select\": {\n//\t\t\t\t\"name\": context\n//\t\t\t}\n//\t\t},\n//\t\t\"Client\": {\n//\t\t    \"select\": {\n//\t\t        \"name\": client\n//\t\t    }\n//\t\t}\n\nmsg.payload = postData\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 660,
        "y": 280,
        "wires": [
            [
                "675ba1c48b1c62d0",
                "b5405e354503bac3"
            ]
        ]
    },
    {
        "id": "675ba1c48b1c62d0",
        "type": "http request",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "create page",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://api.notion.com/v1/pages",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "bearer",
        "senderr": false,
        "x": 930,
        "y": 280,
        "wires": [
            [
                "766b663c01f94543"
            ]
        ]
    },
    {
        "id": "766b663c01f94543",
        "type": "json",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 1070,
        "y": 280,
        "wires": [
            [
                "b5405e354503bac3"
            ]
        ]
    },
    {
        "id": "451f09a2af4d6e01",
        "type": "feedparse",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "url": "https://dash.gregory-ms.com/machine-learning/feed",
        "interval": "2",
        "x": 210,
        "y": 220,
        "wires": [
            []
        ]
    },
    {
        "id": "57cfea48fa20802c",
        "type": "change",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "guid",
                "pt": "msg",
                "to": "article.guid",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 130,
        "y": 280,
        "wires": [
            [
                "102dbb9361d4ea7c"
            ]
        ]
    },
    {
        "id": "102dbb9361d4ea7c",
        "type": "rbe",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "guid",
        "topi": "topic",
        "x": 230,
        "y": 340,
        "wires": [
            [
                "6d80af87a80174dd"
            ]
        ]
    },
    {
        "id": "d2b644450513d5d7",
        "type": "comment",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "Publish Articles on Twitter",
        "info": "",
        "x": 130,
        "y": 180,
        "wires": []
    },
    {
        "id": "16e9023b5711d25b",
        "type": "comment",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "Save tweet in the content calendar so that Automate.io can publish it",
        "info": "",
        "x": 790,
        "y": 220,
        "wires": []
    },
    {
        "id": "6d80af87a80174dd",
        "type": "delay",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "4",
        "rateUnits": "minute",
        "randomFirst": "5",
        "randomLast": "6",
        "randomUnits": "minutes",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 420,
        "y": 280,
        "wires": [
            [
                "45097a07633b6b70"
            ]
        ]
    },
    {
        "id": "9bc6c7bba7adfd60",
        "type": "inject",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "259200",
        "crontab": "",
        "once": true,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT COUNT(*) FROM articles;",
        "payloadType": "str",
        "x": 110,
        "y": 620,
        "wires": [
            [
                "ba0316ca621bfd92"
            ]
        ]
    },
    {
        "id": "d2a475670a8bd9da",
        "type": "change",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0][\"COUNT(*)\"]",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 430,
        "y": 620,
        "wires": [
            [
                "10825c977838e47a"
            ]
        ]
    },
    {
        "id": "4ffe4c1e48afbac8",
        "type": "function",
        "z": "d92bbc0c206c5bfc",
        "name": "Prepare Notion DB payload",
        "func": "\nvar post = `I have found ${msg.payload} articles.`\n\nvar url = 'https://gregory-ms.com/articles/'\n\n\nvar postData = {\n\t\"parent\": { \"database_id\": \"4fa1dc37-a3bf-43be-9c8d-35b41e539f8d\" },\n\t\"properties\": {\n\t\t\"Name\": {\n\t\t\t\"title\": [\n\t\t\t\t{\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"content\": post\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t},\n\t\t\"Status\": {\n\t\t    \"select\": {\n\t\t        \"name\": \"Auto\"\n\t\t    }\n\t\t},\n\t\t\"Link\": {\n            \"url\": url\n        }\n\t\t\n}}\n\n\n\n//\t\t\"Context\": {\n//\t\t\t\"select\": {\n//\t\t\t\t\"name\": context\n//\t\t\t}\n//\t\t},\n//\t\t\"Client\": {\n//\t\t    \"select\": {\n//\t\t        \"name\": client\n//\t\t    }\n//\t\t}\n\nmsg.payload = postData\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 830,
        "y": 620,
        "wires": [
            [
                "73ee42edd63f545a"
            ]
        ]
    },
    {
        "id": "73ee42edd63f545a",
        "type": "http request",
        "z": "d92bbc0c206c5bfc",
        "name": "create page",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://api.notion.com/v1/pages",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "bearer",
        "senderr": false,
        "x": 800,
        "y": 680,
        "wires": [
            [
                "84850bbc1afa9475"
            ]
        ]
    },
    {
        "id": "84850bbc1afa9475",
        "type": "json",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 940,
        "y": 680,
        "wires": [
            []
        ]
    },
    {
        "id": "10825c977838e47a",
        "type": "rbe",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "func": "rbe",
        "gap": "",
        "start": "",
        "inout": "out",
        "septopics": true,
        "property": "payload",
        "topi": "topic",
        "x": 620,
        "y": 620,
        "wires": [
            [
                "4ffe4c1e48afbac8"
            ]
        ]
    },
    {
        "id": "190c1ca8b37decab",
        "type": "inject",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "2220",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 110,
        "y": 860,
        "wires": [
            [
                "50827597b1308ad8"
            ]
        ]
    },
    {
        "id": "4e563f981d9636be",
        "type": "template",
        "z": "d92bbc0c206c5bfc",
        "name": "SQL",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE trials\nSET sent_to_twitter = true\nWHERE trial_id = {{trial_id}};",
        "output": "str",
        "x": 910,
        "y": 940,
        "wires": [
            [
                "8b0380f96c2c3f59"
            ]
        ]
    },
    {
        "id": "351176ef25f86e2a",
        "type": "comment",
        "z": "d92bbc0c206c5bfc",
        "name": "Post new clinical trials",
        "info": "",
        "x": 140,
        "y": 800,
        "wires": []
    },
    {
        "id": "9d85be505a29c03d",
        "type": "switch",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 510,
        "y": 860,
        "wires": [
            [
                "b794036c1fb192c6"
            ],
            []
        ]
    },
    {
        "id": "b794036c1fb192c6",
        "type": "function",
        "z": "d92bbc0c206c5bfc",
        "name": "Prepare Notion DB payload",
        "func": "var data = msg.payload\nvar title = `#ClinicalTrial ${msg.payload.title} `\nvar url = msg.payload.link\n\nvar postData = {\n\t\"parent\": { \"database_id\": \"4fa1dc37-a3bf-43be-9c8d-35b41e539f8d\" },\n\t\"properties\": {\n\t\t\"Name\": {\n\t\t\t\"title\": [\n\t\t\t\t{\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"content\": title\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t},\n\t\t\"Status\": {\n\t\t    \"select\": {\n\t\t        \"name\": \"Auto\"\n\t\t    }\n\t\t},\n        \"Link\": {\n            \"url\": url\n        }\n\t\t\n}}\n\n\n\n//\t\t\"Context\": {\n//\t\t\t\"select\": {\n//\t\t\t\t\"name\": context\n//\t\t\t}\n//\t\t},\n//\t\t\"Client\": {\n//\t\t    \"select\": {\n//\t\t        \"name\": client\n//\t\t    }\n//\t\t}\n\nmsg.payload = postData\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 700,
        "y": 860,
        "wires": [
            [
                "8af055d9ff5c39e3"
            ]
        ]
    },
    {
        "id": "8af055d9ff5c39e3",
        "type": "http request",
        "z": "d92bbc0c206c5bfc",
        "name": "create page",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://api.notion.com/v1/pages",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "bearer",
        "senderr": false,
        "x": 910,
        "y": 860,
        "wires": [
            [
                "c2453000a42e1c9a"
            ]
        ]
    },
    {
        "id": "c2453000a42e1c9a",
        "type": "json",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 790,
        "y": 940,
        "wires": [
            [
                "4e563f981d9636be"
            ]
        ]
    },
    {
        "id": "21ec2168735324ef",
        "type": "inject",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "1020",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "SELECT article_id,ml_prediction_gnb,sent_to_twitter FROM articles WHERE ml_prediction_gnb = true and sent_to_twitter is null or sent_to_twitter = false limit 1;",
        "payloadType": "str",
        "x": 110,
        "y": 1060,
        "wires": [
            [
                "24452f950ea261cb"
            ]
        ]
    },
    {
        "id": "39ae3d72bd4507be",
        "type": "template",
        "z": "d92bbc0c206c5bfc",
        "name": "SQL",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nSET sent_to_twitter = true\nWHERE article_id = {{article_id}};",
        "output": "str",
        "x": 930,
        "y": 1140,
        "wires": [
            [
                "fd3e7381ad602768"
            ]
        ]
    },
    {
        "id": "6b8cf9dc0ef9d225",
        "type": "comment",
        "z": "d92bbc0c206c5bfc",
        "name": "Post new articles",
        "info": "",
        "x": 120,
        "y": 1000,
        "wires": []
    },
    {
        "id": "f24018c473e3c710",
        "type": "switch",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "property": "payload",
        "propertyType": "msg",
        "rules": [
            {
                "t": "nempty"
            },
            {
                "t": "empty"
            }
        ],
        "checkall": "true",
        "repair": false,
        "outputs": 2,
        "x": 710,
        "y": 1060,
        "wires": [
            [
                "dea896e4f9031940"
            ],
            []
        ]
    },
    {
        "id": "c974059772567661",
        "type": "function",
        "z": "d92bbc0c206c5bfc",
        "name": "Prepare Notion DB payload",
        "func": "var data = msg.payload\nvar title = `New article discovered, is it relevant? ${msg.payload.title} `\nvar url = msg.payload.link\n\nvar postData = {\n\t\"parent\": { \"database_id\": \"4fa1dc37-a3bf-43be-9c8d-35b41e539f8d\" },\n\t\"properties\": {\n\t\t\"Name\": {\n\t\t\t\"title\": [\n\t\t\t\t{\n\t\t\t\t\t\"text\": {\n\t\t\t\t\t\t\"content\": title\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t],\n\t\t},\n\t\t\"Status\": {\n\t\t    \"select\": {\n\t\t        \"name\": \"Auto\"\n\t\t    }\n\t\t},\n        \"Link\": {\n            \"url\": url\n        }\n\t\t\n}}\n\n\n\n//\t\t\"Context\": {\n//\t\t\t\"select\": {\n//\t\t\t\t\"name\": context\n//\t\t\t}\n//\t\t},\n//\t\t\"Client\": {\n//\t\t    \"select\": {\n//\t\t        \"name\": client\n//\t\t    }\n//\t\t}\n\nmsg.payload = postData\nreturn msg;",
        "outputs": 1,
        "noerr": 0,
        "initialize": "",
        "finalize": "",
        "libs": [],
        "x": 460,
        "y": 1140,
        "wires": [
            [
                "999e7ee74238730d"
            ]
        ]
    },
    {
        "id": "999e7ee74238730d",
        "type": "http request",
        "z": "d92bbc0c206c5bfc",
        "name": "create page",
        "method": "POST",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://api.notion.com/v1/pages",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "bearer",
        "senderr": false,
        "x": 670,
        "y": 1140,
        "wires": [
            [
                "d4fe05c94ae7f5fe"
            ]
        ]
    },
    {
        "id": "d4fe05c94ae7f5fe",
        "type": "json",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "property": "payload",
        "action": "",
        "pretty": false,
        "x": 810,
        "y": 1140,
        "wires": [
            [
                "39ae3d72bd4507be"
            ]
        ]
    },
    {
        "id": "dea896e4f9031940",
        "type": "change",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "rules": [
            {
                "t": "move",
                "p": "payload.article_id",
                "pt": "msg",
                "to": "article_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 180,
        "y": 1140,
        "wires": [
            [
                "c974059772567661"
            ]
        ]
    },
    {
        "id": "669fcb8867e60fe6",
        "type": "comment",
        "z": "d92bbc0c206c5bfc",
        "name": "Count articles and publish on twitter",
        "info": "",
        "x": 180,
        "y": 560,
        "wires": []
    },
    {
        "id": "1379010ac08b7cb0",
        "type": "comment",
        "z": "d92bbc0c206c5bfc",
        "name": "EXAMPLE ONLY, do not use please",
        "info": "",
        "x": 160,
        "y": 60,
        "wires": []
    },
    {
        "id": "ba0316ca621bfd92",
        "type": "postgres",
        "z": "d92bbc0c206c5bfc",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 260,
        "y": 620,
        "wires": [
            [
                "d2a475670a8bd9da"
            ]
        ]
    },
    {
        "id": "f68fe76d3b14feaa",
        "type": "postgres",
        "z": "d92bbc0c206c5bfc",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 380,
        "y": 860,
        "wires": [
            [
                "9d85be505a29c03d"
            ]
        ]
    },
    {
        "id": "8b0380f96c2c3f59",
        "type": "postgres",
        "z": "d92bbc0c206c5bfc",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": false,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": false,
        "x": 1040,
        "y": 940,
        "wires": []
    },
    {
        "id": "fd3e7381ad602768",
        "type": "postgres",
        "z": "d92bbc0c206c5bfc",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": false,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": false,
        "x": 1060,
        "y": 1140,
        "wires": []
    },
    {
        "id": "40c8ea26f00f36b3",
        "type": "postgres",
        "z": "d92bbc0c206c5bfc",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": true,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 400,
        "y": 1060,
        "wires": [
            [
                "5f3769db596578af"
            ]
        ]
    },
    {
        "id": "24452f950ea261cb",
        "type": "template",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "SELECT\n\tarticle_id,\n\tml_prediction_gnb,\n\tsent_to_twitter\nFROM\n\tarticles\nWHERE\n\tml_prediction_gnb = TRUE\n\tAND sent_to_twitter IS NULL\n\tOR sent_to_twitter = FALSE;",
        "output": "str",
        "x": 240,
        "y": 1060,
        "wires": [
            [
                "40c8ea26f00f36b3"
            ]
        ]
    },
    {
        "id": "50827597b1308ad8",
        "type": "template",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "SELECT\n\t*\nFROM\n\ttrials\nWHERE\n\tsent_to_twitter IS NULL\n\tOR sent_to_twitter = false;",
        "output": "str",
        "x": 240,
        "y": 860,
        "wires": [
            [
                "f68fe76d3b14feaa"
            ]
        ]
    },
    {
        "id": "b5405e354503bac3",
        "type": "debug",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 930,
        "y": 440,
        "wires": []
    },
    {
        "id": "952445cd6a38597e",
        "type": "feedparse",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "url": "https://api.gregory-ms.com/feed/machine-learning",
        "interval": "2",
        "x": 210,
        "y": 400,
        "wires": [
            [
                "44aae1e409356de7"
            ]
        ]
    },
    {
        "id": "44aae1e409356de7",
        "type": "string",
        "z": "d92bbc0c206c5bfc",
        "d": true,
        "name": "",
        "methods": [
            {
                "name": "replaceAll",
                "params": [
                    {
                        "type": "str",
                        "value": "https://gregory-ms.com/articles/"
                    },
                    {
                        "type": "str",
                        "value": ""
                    }
                ]
            },
            {
                "name": "replaceAll",
                "params": [
                    {
                        "type": "str",
                        "value": "/"
                    },
                    {
                        "type": "str",
                        "value": ""
                    }
                ]
            }
        ],
        "prop": "article.guid",
        "propout": "guid",
        "object": "msg",
        "objectout": "msg",
        "x": 470,
        "y": 400,
        "wires": [
            [
                "b5405e354503bac3",
                "102dbb9361d4ea7c"
            ]
        ]
    },
    {
        "id": "5f3769db596578af",
        "type": "delay",
        "z": "d92bbc0c206c5bfc",
        "name": "",
        "pauseType": "delay",
        "timeout": "20",
        "timeoutUnits": "minutes",
        "rate": "1",
        "nbRateUnits": "1",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 570,
        "y": 1060,
        "wires": [
            [
                "f24018c473e3c710"
            ]
        ]
    },
    {
        "id": "572b2daa5e57de56",
        "type": "http in",
        "z": "f8778833ef599a1e",
        "name": "",
        "url": "/contact",
        "method": "post",
        "upload": false,
        "swaggerDoc": "",
        "x": 120,
        "y": 60,
        "wires": [
            [
                "24f7069740f1f3d9",
                "21972aea86ca6b33"
            ]
        ]
    },
    {
        "id": "24f7069740f1f3d9",
        "type": "debug",
        "z": "f8778833ef599a1e",
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 620,
        "y": 220,
        "wires": []
    },
    {
        "id": "21972aea86ca6b33",
        "type": "http response",
        "z": "f8778833ef599a1e",
        "name": "",
        "statusCode": "200",
        "headers": {},
        "x": 380,
        "y": 60,
        "wires": []
    },
    {
        "id": "0dbd418e2d9aa13f",
        "type": "inject",
        "z": "b9a1fa1506c3f2d5",
        "name": "",
        "props": [
            {
                "p": "payload"
            }
        ],
        "repeat": "43200",
        "crontab": "",
        "once": true,
        "onceDelay": "1800",
        "topic": "",
        "payload": "",
        "payloadType": "str",
        "x": 110,
        "y": 80,
        "wires": [
            [
                "58cac40f5bcd4573"
            ]
        ]
    },
    {
        "id": "79ddddf6e7a2e560",
        "type": "template",
        "z": "b9a1fa1506c3f2d5",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "sql",
        "syntax": "mustache",
        "template": "{{#payload}}\nINSERT INTO rel_articles_categories (article_id, category_id)\n\nSELECT\n\tarticles.article_id,\n\tcategories.category_id\nFROM\n\tcategories\n\tINNER JOIN articles ON articles.title LIKE '%{{category_name}}%'\n\t\tAND categories.category_id = '{{category_id}}'\n\n{{/payload}}\n",
        "output": "str",
        "x": 380,
        "y": 220,
        "wires": [
            [
                "fd15a0b13f097b23"
            ]
        ]
    },
    {
        "id": "dda6c2d10679678a",
        "type": "debug",
        "z": "b9a1fa1506c3f2d5",
        "name": "",
        "active": false,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 390,
        "y": 280,
        "wires": []
    },
    {
        "id": "37a51beeada5dc77",
        "type": "split",
        "z": "b9a1fa1506c3f2d5",
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 250,
        "y": 220,
        "wires": [
            [
                "79ddddf6e7a2e560"
            ]
        ]
    },
    {
        "id": "748187b825f56963",
        "type": "postgres",
        "z": "b9a1fa1506c3f2d5",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 440,
        "y": 80,
        "wires": [
            [
                "f340caead90601be"
            ]
        ]
    },
    {
        "id": "0d2c204765f03ad6",
        "type": "postgres",
        "z": "b9a1fa1506c3f2d5",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 440,
        "y": 140,
        "wires": [
            [
                "37a51beeada5dc77"
            ]
        ]
    },
    {
        "id": "fd15a0b13f097b23",
        "type": "postgres",
        "z": "b9a1fa1506c3f2d5",
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": true,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": true,
        "x": 260,
        "y": 280,
        "wires": [
            [
                "dda6c2d10679678a"
            ]
        ]
    },
    {
        "id": "58cac40f5bcd4573",
        "type": "template",
        "z": "b9a1fa1506c3f2d5",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "DELETE FROM rel_articles_categories ;",
        "output": "str",
        "x": 260,
        "y": 80,
        "wires": [
            [
                "748187b825f56963"
            ]
        ]
    },
    {
        "id": "f340caead90601be",
        "type": "template",
        "z": "b9a1fa1506c3f2d5",
        "name": "",
        "field": "payload",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": " select category_name,category_id from categories;",
        "output": "str",
        "x": 260,
        "y": 160,
        "wires": [
            [
                "0d2c204765f03ad6"
            ]
        ]
    },
    {
        "id": "bdf7dcf7e77c8fb1",
        "type": "http request",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "journals.sagepub",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "https://journals.sagepub.com/action/doSearch?AllField=multiple+sclerosis&SeriesKey=msja&content=articlesChapters&countTerms=true&target=default&sortBy=Ppub&startPage=&ContentItemType=research-article",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "senderr": false,
        "x": 350,
        "y": 80,
        "wires": [
            [
                "b10e446e32a599c1",
                "bf7261993e7a2040"
            ]
        ]
    },
    {
        "id": "357f624d0bda7d21",
        "type": "inject",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "source",
                "v": "9",
                "vt": "num"
            }
        ],
        "repeat": "86400",
        "crontab": "",
        "once": true,
        "onceDelay": "99",
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 170,
        "y": 80,
        "wires": [
            [
                "bdf7dcf7e77c8fb1"
            ]
        ]
    },
    {
        "id": "b11c5b63379dd054",
        "type": "split",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "article.key",
        "x": 790,
        "y": 80,
        "wires": [
            [
                "21a6f750c3abb2a1"
            ]
        ]
    },
    {
        "id": "21a6f750c3abb2a1",
        "type": "change",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "set source SagePub",
        "rules": [
            {
                "t": "set",
                "p": "article",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article.url",
                "pt": "msg",
                "to": "\"https://journals.sagepub.com\" & payload.link",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "article.source",
                "pt": "msg",
                "to": "Sage Pub",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.description",
                "pt": "msg",
                "to": "not available",
                "tot": "str"
            },
            {
                "t": "set",
                "p": "article.title",
                "pt": "msg",
                "to": "$trim(article.title)",
                "tot": "jsonata"
            },
            {
                "t": "set",
                "p": "payload.pubdate",
                "pt": "msg",
                "to": "$split($trim($replace(article.pubdate, \", First Published \", \" \")),\".\",1)",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 960,
        "y": 80,
        "wires": [
            [
                "a171fa7197616bce"
            ]
        ]
    },
    {
        "id": "a171fa7197616bce",
        "type": "change",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "fix pubdate",
        "rules": [
            {
                "t": "set",
                "p": "payload.pubdate",
                "pt": "msg",
                "to": "$replace($replace(payload.pubdate[0],\" \", \"-\"),\",\",\"\")",
                "tot": "jsonata"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 1150,
        "y": 80,
        "wires": [
            [
                "a5a10522b92c0bb6"
            ]
        ]
    },
    {
        "id": "b37b5d10ade11d4b",
        "type": "subflow:3d5c22a1ade8c013",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "Insert SQL",
        "env": [],
        "x": 810,
        "y": 180,
        "wires": [
            [
                "cc064dd2df5af8ab",
                "df7d1918121d6cbf"
            ]
        ]
    },
    {
        "id": "b10e446e32a599c1",
        "type": "cheerio",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "tag": ".searchResultItem",
        "ret": "object",
        "as": "single",
        "map": [
            {
                "search": "h2",
                "ret": "text",
                "replace": "title",
                "attr": ""
            },
            {
                "search": "h2>span>a",
                "ret": "attribute",
                "replace": "link",
                "attr": "href"
            },
            {
                "search": "div.hlFld-Abstract.preview-abstract",
                "ret": "text",
                "replace": "description",
                "attr": ""
            },
            {
                "search": "span.publication-meta",
                "ret": "text",
                "replace": "pubdate",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": true,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 570,
        "y": 80,
        "wires": [
            [
                "b11c5b63379dd054",
                "bf7261993e7a2040"
            ]
        ]
    },
    {
        "id": "a5a10522b92c0bb6",
        "type": "moment",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "format pubdate",
        "topic": "",
        "input": "payload.pubdate",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": 0,
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "en-US",
        "output": "article.pubdate",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 640,
        "y": 180,
        "wires": [
            [
                "b37b5d10ade11d4b"
            ]
        ]
    },
    {
        "id": "a9148801c21f3d41",
        "type": "subflow:346ec29c7e27ea2e",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "x": 1450,
        "y": 300,
        "wires": [
            [
                "56f1dd10efc3af92"
            ]
        ]
    },
    {
        "id": "56f1dd10efc3af92",
        "type": "debug",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "false",
        "statusVal": "",
        "statusType": "auto",
        "x": 1740,
        "y": 340,
        "wires": []
    },
    {
        "id": "19d9880ce23b17d8",
        "type": "comment",
        "z": "a38a4dce4a95b8aa",
        "name": "ADD SAGEPUB SUMMARY",
        "info": "",
        "x": 200,
        "y": 240,
        "wires": []
    },
    {
        "id": "0fdf992e2a4b31c7",
        "type": "split",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "splt": "\\n",
        "spltType": "str",
        "arraySplt": 1,
        "arraySpltType": "len",
        "stream": false,
        "addname": "",
        "x": 540,
        "y": 280,
        "wires": [
            [
                "2c174e0bece2c39c"
            ]
        ]
    },
    {
        "id": "934464ff05531550",
        "type": "http request",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "SAGEPUB",
        "method": "GET",
        "ret": "txt",
        "paytoqs": "ignore",
        "url": "",
        "tls": "e3876559.c845b8",
        "persist": false,
        "proxy": "",
        "authType": "",
        "x": 860,
        "y": 320,
        "wires": [
            [
                "ad04d9fa569437b8"
            ]
        ]
    },
    {
        "id": "513f9aa2bc88dd23",
        "type": "change",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "set fields",
        "rules": [
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload.link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload.article_id",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 690,
        "y": 320,
        "wires": [
            [
                "934464ff05531550"
            ]
        ]
    },
    {
        "id": "f29328b354aedc36",
        "type": "template",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "UPDATE articles\nset summary = \"{{{payload.summary}}}\"\nwhere article_id = {{article_id}};",
        "output": "str",
        "x": 1130,
        "y": 320,
        "wires": [
            [
                "a9148801c21f3d41"
            ]
        ]
    },
    {
        "id": "0bdbbe7165770dca",
        "type": "inject",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "props": [
            {
                "p": "payload"
            },
            {
                "p": "topic",
                "vt": "str"
            }
        ],
        "repeat": "7200",
        "crontab": "",
        "once": false,
        "onceDelay": 0.1,
        "topic": "",
        "payload": "",
        "payloadType": "date",
        "x": 150,
        "y": 280,
        "wires": [
            [
                "1916487558ba2188"
            ]
        ]
    },
    {
        "id": "2c174e0bece2c39c",
        "type": "delay",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "pauseType": "rate",
        "timeout": "5",
        "timeoutUnits": "seconds",
        "rate": "1",
        "nbRateUnits": "30",
        "rateUnits": "second",
        "randomFirst": "1",
        "randomLast": "5",
        "randomUnits": "seconds",
        "drop": false,
        "allowrate": false,
        "outputs": 1,
        "x": 530,
        "y": 340,
        "wires": [
            [
                "513f9aa2bc88dd23"
            ]
        ]
    },
    {
        "id": "ad04d9fa569437b8",
        "type": "cheerio",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "tag": "body",
        "ret": "object",
        "as": "multi",
        "map": [
            {
                "search": "div.hlFld-Abstract",
                "ret": "text",
                "replace": "summary",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": false,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 1000,
        "y": 320,
        "wires": [
            [
                "f29328b354aedc36"
            ]
        ]
    },
    {
        "id": "1916487558ba2188",
        "type": "sqlite",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "mydb": "9ccc1658.e12858",
        "sqlquery": "fixed",
        "sql": "SELECT * FROM articles \nWHERE source = \"Sage Pub\" \nAND summary =\"not available\";",
        "name": "",
        "x": 380,
        "y": 280,
        "wires": [
            [
                "0fdf992e2a4b31c7"
            ]
        ]
    },
    {
        "id": "33f3921a91b80ed9",
        "type": "debug",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "article_id",
        "targetType": "msg",
        "statusVal": "",
        "statusType": "auto",
        "x": 800,
        "y": 700,
        "wires": []
    },
    {
        "id": "c49f486b8e6b37b2",
        "type": "sqlite",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "mydb": "9ccc1658.e12858",
        "sqlquery": "fixed",
        "sql": "select article_id,link from articles where source = \"Sage Pub\" and published_date = \"\" limit 1;",
        "name": "",
        "x": 350,
        "y": 540,
        "wires": [
            [
                "5e2944c15177ab7b"
            ]
        ]
    },
    {
        "id": "5e2944c15177ab7b",
        "type": "change",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "rules": [
            {
                "t": "set",
                "p": "article_id",
                "pt": "msg",
                "to": "payload[0].article_id",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "payload",
                "pt": "msg",
                "to": "payload[0].link",
                "tot": "msg"
            },
            {
                "t": "set",
                "p": "url",
                "pt": "msg",
                "to": "payload",
                "tot": "msg"
            }
        ],
        "action": "",
        "property": "",
        "from": "",
        "to": "",
        "reg": false,
        "x": 540,
        "y": 540,
        "wires": [
            [
                "0fefe071b1bb64db"
            ]
        ]
    },
    {
        "id": "e38f3f3c4b39932b",
        "type": "sqlite",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "mydb": "9ccc1658.e12858",
        "sqlquery": "msg.topic",
        "sql": "",
        "name": "",
        "x": 590,
        "y": 700,
        "wires": [
            [
                "33f3921a91b80ed9"
            ]
        ]
    },
    {
        "id": "4c63900676c67787",
        "type": "comment",
        "z": "a38a4dce4a95b8aa",
        "name": "populate missing values of published date not working",
        "info": "",
        "x": 310,
        "y": 480,
        "wires": []
    },
    {
        "id": "0fefe071b1bb64db",
        "type": "http request",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "method": "GET",
        "ret": "txt",
        "paytoqs": false,
        "url": "",
        "persist": false,
        "authType": "",
        "senderr": false,
        "x": 130,
        "y": 620,
        "wires": [
            [
                "9b5e007c73488db0"
            ]
        ]
    },
    {
        "id": "9b5e007c73488db0",
        "type": "cheerio",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "tag": ".publicationContentEpubDate.dates",
        "ret": "html",
        "as": "single",
        "map": [
            {
                "search": "",
                "ret": "html",
                "replace": "",
                "attr": ""
            }
        ],
        "xmlMode": false,
        "decodeEntities": false,
        "lowerCaseTags": false,
        "lowerCaseAttributeNames": false,
        "recognizeCDATA": false,
        "recognizeSelfClosing": false,
        "x": 390,
        "y": 620,
        "wires": [
            [
                "041fcb5ee56c8e57"
            ]
        ]
    },
    {
        "id": "041fcb5ee56c8e57",
        "type": "string",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "methods": [
            {
                "name": "trim",
                "params": []
            },
            {
                "name": "delLeftMost",
                "params": [
                    {
                        "type": "str",
                        "value": "<b>First Published </b> "
                    }
                ]
            }
        ],
        "prop": "payload[0]",
        "propout": "payload",
        "object": "msg",
        "objectout": "msg",
        "x": 610,
        "y": 620,
        "wires": [
            [
                "eb757de17b81869f",
                "df7d1918121d6cbf"
            ]
        ]
    },
    {
        "id": "eb757de17b81869f",
        "type": "moment",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "topic": "",
        "input": "payload",
        "inputType": "msg",
        "inTz": "Europe/Lisbon",
        "adjAmount": "1",
        "adjType": "days",
        "adjDir": "add",
        "format": "",
        "locale": "POSIX",
        "output": "",
        "outputType": "msg",
        "outTz": "Europe/Lisbon",
        "x": 180,
        "y": 700,
        "wires": [
            [
                "1544defd6dc58dbb"
            ]
        ]
    },
    {
        "id": "1544defd6dc58dbb",
        "type": "template",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "field": "topic",
        "fieldType": "msg",
        "format": "handlebars",
        "syntax": "mustache",
        "template": "update articles set published_date ='{{payload}}' where article_id  = {{article_id}};",
        "output": "str",
        "x": 380,
        "y": 700,
        "wires": [
            [
                "e38f3f3c4b39932b"
            ]
        ]
    },
    {
        "id": "df7d1918121d6cbf",
        "type": "debug",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 810,
        "y": 540,
        "wires": []
    },
    {
        "id": "cc064dd2df5af8ab",
        "type": "postgres",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "postgresdb": "857f821ab371a10e",
        "name": "",
        "output": false,
        "perrow": false,
        "rowspermsg": "1",
        "return_on_error": false,
        "limit_queries": "0",
        "limit_by": "payload",
        "limit_value": "1",
        "limit_drop_intermediate": false,
        "limit_drop_if_in_queue": false,
        "outputs": false,
        "x": 1060,
        "y": 220,
        "wires": []
    },
    {
        "id": "bf7261993e7a2040",
        "type": "debug",
        "z": "a38a4dce4a95b8aa",
        "d": true,
        "name": "",
        "active": true,
        "tosidebar": true,
        "console": false,
        "tostatus": false,
        "complete": "true",
        "targetType": "full",
        "statusVal": "",
        "statusType": "auto",
        "x": 460,
        "y": 200,
        "wires": []
    }
]